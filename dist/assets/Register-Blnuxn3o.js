import{k as q,b as G,e as R,l as A,r as N,f as E,j as e,L as F,p as j,t as C,U as v,M as _,i as M}from"./index-CeiZKB8G.js";import{c as O,a as b,e as T,F as U,b as D,d as p,E as w}from"./index.esm-CrTxtpVV.js";import{c as z}from"./crosswalk-C791ooMc.js";import{L as I}from"./lock-BTl28dPZ.js";/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],$=q("EyeOff",J);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],L=q("Eye",H),Y=s=>{if(!s)return{score:0,label:"empty",color:"gray-300",feedback:"Enter a password"};let a=0,r=[];s.length<8?r.push("Password should be at least 8 characters"):a+=s.length>12?2:1;const d=/[A-Z]/.test(s),u=/[a-z]/.test(s),g=/[0-9]/.test(s),f=/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(s);d&&(a+=1),u&&(a+=1),g&&(a+=1),f&&(a+=1),d||r.push("Add uppercase letters"),u||r.push("Add lowercase letters"),g||r.push("Add numbers"),f||r.push("Add special characters");let m="weak",o="red-500";return a>=6?(m="strong",o="green-500"):a>=4&&(m="moderate",o="yellow-500"),{score:a,label:m,color:o,feedback:r.length>0?r.join(", "):"Strong password"}},P="auth_verification_data",K={saveVerificationData:s=>{if(!s||!s.userId||!s.email)return console.error("Cannot save invalid verification data",s),!1;try{return sessionStorage.setItem(P,JSON.stringify(s)),!0}catch(a){return console.error("Error saving verification data",a),!1}},getVerificationData:()=>{try{const s=sessionStorage.getItem(P);return s?JSON.parse(s):null}catch(s){return console.error("Error retrieving verification data",s),null}},clearVerificationData:()=>{try{return sessionStorage.removeItem(P),!0}catch(s){return console.error("Error clearing verification data",s),!1}}},Z=()=>{const s=G(),a=R(),{startLoading:r,stopLoading:d}=A(),[u,g]=N.useState(!1),[f,m]=N.useState(!1),[o,y]=N.useState({score:0,label:"empty",color:"gray-300",feedback:"Enter a password"}),c=(t,l,i)=>{K.saveVerificationData({userId:t,email:l,isNewRegistration:!0,provider:i,returnTo:"/dashboard"}),s("/verify-email",{state:{userId:t,email:l,isNewRegistration:!0,provider:i,returnTo:"/dashboard"}})};return{formValues:{firstName:"",lastName:"",email:"",phone:"",password:"",confirmPassword:""},passwordVisibility:{passwordVisible:u,confirmPasswordVisible:f},passwordStrength:o,formHandlers:{handleSubmit:async(t,{setSubmitting:l})=>{var i;r(),l(!0);try{const n=await E.register({firstName:t.firstName,lastName:t.lastName,email:t.email,password:t.password,phone:t.phone||""});if(n.success){const h=n.userId||((i=n.user)==null?void 0:i.id);if(!h)throw new Error("Registration successful but user ID is missing");a.success("Registration successful! Please verify your email."),c(h,t.email,"email")}}catch(n){console.error("Registration error:",n),a.error(n.message||"Registration failed. Please try again.")}finally{d(),l(!1)}},handleGoogleSignUp:async()=>{var t,l;r();try{const i=await E.googleSignIn();if(i.requireVerification){const n=i.userId||((t=i.user)==null?void 0:t.id),h=i.email||((l=i.user)==null?void 0:l.email);if(!n||!h)throw new Error("Google sign-up successful but required user data is missing");a.success("Google sign-up successful! Please verify your email."),c(n,h,"google")}else a.success("Google sign-in successful!"),setTimeout(()=>{s("/dashboard")},800)}catch(i){if(console.error("Google sign-up error:",i),i.code)switch(i.code){case"auth/popup-closed-by-user":a.error("Sign-up canceled. You closed the popup.");break;case"auth/popup-blocked":a.error("Sign-up popup was blocked by your browser. Please enable popups.");break;case"auth/account-exists-with-different-credential":a.error("An account already exists with the same email address but different sign-in credentials.");break;default:a.error(`Google sign-up failed: ${i.message}`)}else a.error(i.message||"Google sign-up failed. Please try again.")}finally{d()}},togglePasswordVisibility:()=>{g(t=>!t)},toggleConfirmPasswordVisibility:()=>{m(t=>!t)},handlePasswordChange:(t,l)=>{const i=t.target.value;y(Y(i)),l&&l(t)}}}},B=O().shape({firstName:b().required("First name is required"),lastName:b().required("Last name is required"),email:b().email("Invalid email").required("Email is required"),password:b().min(6,"Password must be at least 6 characters").required("Password is required"),confirmPassword:b().oneOf([T("password"),null],"Passwords must match").required("Confirm password is required")}),Q={firstName:"",lastName:"",email:"",password:"",confirmPassword:""},re=()=>{const{passwordVisibility:{passwordVisible:s,confirmPasswordVisible:a},passwordStrength:r,formHandlers:{handleSubmit:d,handleGoogleSignUp:u,togglePasswordVisibility:g,toggleConfirmPasswordVisibility:f,handlePasswordChange:m}}=Z(),{isLoading:o}=A();return e.jsxs(e.Fragment,{children:[e.jsx(F,{}),e.jsxs("div",{className:"flex min-h-screen",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center flex-1 p-12 text-center",style:{background:`linear-gradient(135deg, ${j.main}, ${j.dark})`},children:[e.jsx("img",{src:"/logo.png",alt:"EcoPulse Logo",className:"w-32 h-32 mb-6"}),e.jsx("h1",{className:"mb-6 text-5xl font-bold text-white",children:"EcoPulse"}),e.jsx("p",{className:"text-lg leading-relaxed text-white/80 max-w-md",children:"Join our community of eco-conscious individuals and businesses. Together, we can make a difference for a sustainable future."})]}),e.jsxs("div",{className:"relative flex items-center justify-center w-1/2 bg-center bg-cover",style:{backgroundImage:`url(${z})`,backgroundSize:"cover",backgroundPosition:"center"},children:[e.jsx("div",{className:"absolute inset-0",style:{backgroundColor:"rgba(255, 255, 255, 0.9)"}}),e.jsxs("div",{className:"relative z-10 w-full max-w-md p-8 mx-12 bg-white shadow-xl rounded-3xl",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center",style:{border:`2px solid ${C.main}`},children:e.jsx(v,{className:"w-8 h-8",style:{color:j.main}})})}),e.jsx("h2",{className:"text-2xl font-bold text-center mb-6",style:{color:C.main},children:"Create Account"}),e.jsx(U,{initialValues:Q,validationSchema:B,onSubmit:d,children:({isSubmitting:y,touched:c,errors:x,values:k,handleChange:S})=>e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"relative flex items-center",children:[e.jsx(v,{className:"absolute left-3 w-4 h-4 text-gray-400"}),e.jsx(p,{type:"text",name:"firstName",placeholder:"First Name *",className:`w-full h-10 pl-9 pr-3 border rounded-lg text-sm ${c.firstName&&x.firstName?"border-red-500":"border-gray-300"}`,disabled:o})]}),e.jsx(w,{name:"firstName",component:"div",className:"text-xs text-red-500 mt-1"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"relative flex items-center",children:[e.jsx(v,{className:"absolute left-3 w-4 h-4 text-gray-400"}),e.jsx(p,{type:"text",name:"lastName",placeholder:"Last Name *",className:`w-full h-10 pl-9 pr-3 border rounded-lg text-sm ${c.lastName&&x.lastName?"border-red-500":"border-gray-300"}`,disabled:o})]}),e.jsx(w,{name:"lastName",component:"div",className:"text-xs text-red-500 mt-1"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"relative flex items-center",children:[e.jsx(_,{className:"absolute left-3 w-4 h-4 text-gray-400"}),e.jsx(p,{type:"email",name:"email",placeholder:"Email *",className:`w-full h-10 pl-9 pr-3 border rounded-lg text-sm ${c.email&&x.email?"border-red-500":"border-gray-300"}`,disabled:o})]}),e.jsx(w,{name:"email",component:"div",className:"text-xs text-red-500 mt-1"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"relative flex items-center",children:[e.jsx(I,{className:"absolute left-3 w-4 h-4 text-gray-400"}),e.jsx(p,{type:s?"text":"password",name:"password",placeholder:"Password *",className:`w-full h-10 pl-9 pr-10 border rounded-lg text-sm ${c.password&&x.password?"border-red-500":"border-gray-300"}`,disabled:o,onChange:V=>m(V,S)}),e.jsx("button",{type:"button",className:"absolute right-3 text-gray-400 hover:text-gray-600",onClick:g,tabIndex:"-1",children:s?e.jsx($,{className:"w-4 h-4"}):e.jsx(L,{className:"w-4 h-4"})})]}),k.password&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"w-full h-1 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full",style:{width:`${r.score/6*100}%`,backgroundColor:r.color==="red-500"?"#ef4444":r.color==="yellow-500"?"#eab308":r.color==="green-500"?"#22c55e":"#d1d5db"}})}),e.jsxs("p",{className:"text-xs mt-1",style:{color:r.color==="red-500"?"#ef4444":r.color==="yellow-500"?"#eab308":r.color==="green-500"?"#22c55e":"#6b7280"},children:["Password strength: ",r.label," - ",r.feedback]})]}),e.jsx(w,{name:"password",component:"div",className:"text-xs text-red-500 mt-1"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"relative flex items-center",children:[e.jsx(I,{className:"absolute left-3 w-4 h-4 text-gray-400"}),e.jsx(p,{type:a?"text":"password",name:"confirmPassword",placeholder:"Confirm Password *",className:`w-full h-10 pl-9 pr-10 border rounded-lg text-sm ${c.confirmPassword&&x.confirmPassword?"border-red-500":"border-gray-300"}`,disabled:o}),e.jsx("button",{type:"button",className:"absolute right-3 text-gray-400 hover:text-gray-600",onClick:f,tabIndex:"-1",children:a?e.jsx($,{className:"w-4 h-4"}):e.jsx(L,{className:"w-4 h-4"})})]}),e.jsx(w,{name:"confirmPassword",component:"div",className:"text-xs text-red-500 mt-1"})]}),e.jsx("button",{type:"submit",disabled:y||o,className:"w-full h-10 bg-green-700 text-white rounded-lg font-medium hover:bg-green-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:y||o?"Creating Account...":"Create Account"}),e.jsxs("div",{className:"relative py-2",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center",children:e.jsx("span",{className:"px-4 text-xs text-gray-500 bg-white",children:"Or continue with"})})]}),e.jsxs("button",{type:"button",onClick:u,disabled:o,className:"w-full h-10 flex items-center justify-center gap-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:[e.jsx("img",{src:"/google.svg",alt:"Google",className:"w-4 h-4"}),e.jsx("span",{children:"Sign up with Google"})]}),e.jsxs("div",{className:"text-center text-xs text-gray-600",children:["Already have an account?"," ",e.jsx(M,{to:"/login",className:"font-medium text-green-700 hover:underline",children:"Login now"})]})]})})]})]})]})]})};export{re as default};
