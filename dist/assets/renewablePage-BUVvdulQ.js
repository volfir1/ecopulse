import{k as w,b as B,r as i,j as e,B as o,T as n,a as g,P as O,ac as J,C as H,K as k,W as F}from"./index-D-CDyacC.js";import{a as A}from"./api-DsXL_j3W.js";import{C as K}from"./Container-CGi0RHh_.js";import{R as q}from"./refresh-cw-BS07gTpP.js";import{D as Q}from"./download-Bpcn7y8l.js";import{T as U,a as V}from"./Tabs-Crx7z2dm.js";import{C as v}from"./chart-column-CEJ09_RC.js";import{G as C}from"./Grid-Bn1cnVmp.js";import{L as W}from"./leaf-DZxmOhLq.js";import"./axios-CmsuhreG.js";import"./styled-DgJJown5.js";import"./useThemeProps-CpDca6ZV.js";import"./KeyboardArrowRight-DEGN5Fl8.js";/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]],$=w("Flame",X);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],T=w("Plus",Z);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],_=w("Waves",ee),ae=[{id:"all",label:"All Energy",icon:e.jsx(v,{size:20})},{id:"solar",label:"Solar",icon:e.jsx(k,{size:20})},{id:"wind",label:"Wind",icon:e.jsx(F,{size:20})},{id:"hydro",label:"Hydro",icon:e.jsx(_,{size:20})},{id:"geothermal",label:"Geothermal",icon:e.jsx($,{size:20})},{id:"biomass",label:"Biomass",icon:e.jsx(W,{size:20})}],G=p=>typeof p=="string"?p.replace(/NaN/g,"null"):JSON.stringify(p).replace(/NaN/g,"null"),me=()=>{const p=B(),[E,x]=i.useState([]),[D,y]=i.useState(!1),[r,M]=i.useState("all"),[u,se]=i.useState(new Date().getFullYear()-10),[h,re]=i.useState(new Date().getFullYear()),m=i.useCallback(async()=>{y(!0);try{const a=r==="all"?"solar":r,c=await A.get(`/api/predictions/${a}/?start_year=${u}&end_year=${h}`),z=typeof c.data=="string"?c.data:JSON.stringify(c.data),j=G(z),d=JSON.parse(j);if(d.status==="success"&&Array.isArray(d.predictions)){const l=d.predictions.filter(s=>!s.isPredicted).map(s=>({id:s.id||Math.random().toString(36).substr(2,9),type:r==="all"?a:r,year:s.Year,generation:parseFloat(s["Predicted Production"]),nonRenewableEnergy:s["Non-Renewable Energy (GWh)"]?parseFloat(s["Non-Renewable Energy (GWh)"]):null,population:s["Population (in millions)"]?parseFloat(s["Population (in millions)"]):null,gdp:s["Gross Domestic Product"]===null?null:parseFloat(s["Gross Domestic Product"]),isPredicted:!1,dateAdded:s.createdAt||new Date().toISOString(),isDeleted:s.isDeleted||!1})).filter(s=>!s.isDeleted);x(s=>r==="all"?[...s.filter(b=>b.type!==a),...l]:l)}}catch(a){console.error("Error fetching data:",a)}finally{y(!1)}},[r,u,h]),f=i.useCallback(async()=>{y(!0);try{x([]);const c=["solar","wind","hydro","geothermal","biomass"].map(async d=>{try{const l=await A.get(`/api/predictions/${d}/?start_year=${u}&end_year=${h}`),s=typeof l.data=="string"?l.data:JSON.stringify(l.data),b=G(s),N=JSON.parse(b);return N.status==="success"&&Array.isArray(N.predictions)?N.predictions.filter(t=>!t.isPredicted).map(t=>({id:t.id||Math.random().toString(36).substr(2,9),type:d,year:t.Year,generation:parseFloat(t["Predicted Production"]),nonRenewableEnergy:t["Non-Renewable Energy (GWh)"]?parseFloat(t["Non-Renewable Energy (GWh)"]):null,population:t["Population (in millions)"]?parseFloat(t["Population (in millions)"]):null,gdp:t["Gross Domestic Product"]===null?null:parseFloat(t["Gross Domestic Product"]),isPredicted:!1,dateAdded:t.createdAt||new Date().toISOString(),isDeleted:t.isDeleted||!1})).filter(t=>!t.isDeleted):[]}catch(l){return console.error(`Error fetching ${d} data:`,l),[]}}),j=(await Promise.all(c)).flat();x(j)}catch(a){console.error("Error fetching all energy types:",a)}finally{y(!1)}},[u,h]);i.useEffect(()=>{r==="all"?f():m()},[r,m,f]);const Y=(a,c)=>{M(c)},P=()=>{p("/admin/modules/add",{state:{energyType:r==="all"?"solar":r}})},I=()=>{console.log("Exporting data...")},S=r==="all"?E:E.filter(a=>a.type===r),R=a=>{switch(a){case"solar":return"warning";case"wind":return"primary";case"hydro":return"info";case"geothermal":return"error";case"biomass":return"success";default:return"default"}},L=a=>{switch(a){case"solar":return e.jsx(k,{size:16});case"wind":return e.jsx(F,{size:16});case"hydro":return e.jsx(_,{size:16});case"geothermal":return e.jsx($,{size:16});case"biomass":return e.jsx(W,{size:16});default:return e.jsx(v,{size:16})}};return e.jsxs(K,{maxWidth:"xl",className:"py-6",children:[e.jsxs(o,{className:"flex justify-between items-center mb-6",children:[e.jsx(n,{variant:"h4",component:"h1",className:"font-bold",children:"Renewable Energy Data"}),e.jsxs(o,{className:"flex gap-2",children:[e.jsx(g,{variant:"outlined",startIcon:e.jsx(q,{size:18}),onClick:r==="all"?f:m,disabled:D,children:"Refresh"}),e.jsx(g,{variant:"outlined",color:"primary",startIcon:e.jsx(Q,{size:18}),onClick:I,children:"Export"}),e.jsx(g,{variant:"contained",color:"primary",startIcon:e.jsx(T,{size:18}),onClick:P,children:"Add Record"})]})]}),e.jsx(O,{sx:{marginBottom:3},elevation:0,className:"border",children:e.jsx(U,{value:r,onChange:Y,variant:"scrollable",scrollButtons:"auto","aria-label":"energy type tabs",children:ae.map(a=>e.jsx(V,{value:a.id,icon:a.icon,label:a.label,iconPosition:"start"},a.id))})}),e.jsx(o,{className:"mb-6",children:D?e.jsx(o,{className:"py-12 flex justify-center items-center",children:e.jsx(J,{})}):S.length===0?e.jsxs(o,{className:"py-12 flex flex-col justify-center items-center border border-dashed rounded-lg bg-gray-50",children:[e.jsx(v,{size:40,className:"text-gray-400 mb-2"}),e.jsx(n,{variant:"h6",className:"text-gray-600 mb-1",children:"No Records Found"}),e.jsx(n,{variant:"body2",className:"text-gray-500 mb-4",children:r==="all"?"There are no energy records available.":`There are no ${r} energy records available.`}),e.jsx(g,{variant:"contained",startIcon:e.jsx(T,{size:18}),onClick:P,children:"Add New Record"})]}):e.jsx(C,{container:!0,spacing:3,children:S.map(a=>e.jsx(C,{item:!0,xs:12,sm:6,md:4,children:e.jsx(H,{className:"h-full",children:e.jsxs(o,{className:"p-4",children:[e.jsxs(o,{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:`p-2 rounded-full bg-${R(a.type)}-50`,children:L(a.type)}),e.jsxs(n,{variant:"h6",className:"font-medium",children:["Year ",a.year]}),e.jsx(n,{variant:"caption",className:"text-gray-500 capitalize ml-auto",children:a.type})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(n,{variant:"body2",color:"text.secondary",className:"mb-1",children:"Energy Generation"}),e.jsxs(n,{variant:"h5",color:R(a.type),className:"font-bold",children:[a.generation.toLocaleString()," GWh"]})]}),e.jsxs(o,{className:"grid grid-cols-2 gap-x-4 gap-y-2",children:[e.jsxs(o,{children:[e.jsx(n,{variant:"caption",color:"text.secondary",children:"Non-Renewable"}),e.jsx(n,{variant:"body2",children:a.nonRenewableEnergy?a.nonRenewableEnergy.toLocaleString()+" GWh":"N/A"})]}),e.jsxs(o,{children:[e.jsx(n,{variant:"caption",color:"text.secondary",children:"Population"}),e.jsx(n,{variant:"body2",children:a.population?a.population+"M":"N/A"})]}),e.jsxs(o,{children:[e.jsx(n,{variant:"caption",color:"text.secondary",children:"GDP"}),e.jsx(n,{variant:"body2",children:a.gdp?"$"+a.gdp.toLocaleString()+"B":"N/A"})]}),e.jsxs(o,{children:[e.jsx(n,{variant:"caption",color:"text.secondary",children:"Date Added"}),e.jsx(n,{variant:"body2",children:new Date(a.dateAdded).toLocaleDateString()})]})]})]})})},a.id))})})]})};export{me as default};
