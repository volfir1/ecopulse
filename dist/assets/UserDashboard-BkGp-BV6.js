import{k as se,r as g,j as e,g as re,N as be,O as we,W as ye,P as oe,i as je}from"./index-CeiZKB8G.js";import{c as ve,A as ne,a as le,g as Ne}from"./useEnergyStore-rUER5IT3.js";import{R as ee}from"./refresh-cw-DlOnahB6.js";import{X as Se}from"./x-CZmEDHb-.js";import{D as ke}from"./droplets-kF6qgtD3.js";import{L as Ee}from"./leaf-De0UsZzf.js";import{T as De}from"./thermometer-BiCz2k3Y.js";import{R as Z,C as Ae,a as Ce,X as ie,Y as Ie,T as ce,L as Pe}from"./generateCategoricalChart-D0QOHPu-.js";import{P as Te,a as Re}from"./PieChart-CyEQmZbr.js";import{C as Me}from"./chart-column-DTK4o2RB.js";import{A as $e}from"./arrow-up-right-Cf_PwKT_.js";import"./html2canvas.esm-CBrSDip1.js";import"./tup_logo-CddcVZx9.js";import"./index-BGHELInD.js";/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],ze=se("Bookmark",Le);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Fe=se("ExternalLink",Ue);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],We=se("Share2",Oe),$={solar:"#FFB800",hydro:"#2E90E5",wind:"#64748B",biomass:"#16A34A",geothermal:"#FF6B6B",general:"#6366F1"},de=[{url:"https://www.renewableenergyworld.com/feed/",name:"Renewable Energy World",reliable:!0},{url:"https://cleantechnica.com/feed/",name:"CleanTechnica",reliable:!0},{url:"https://www.solarpowerworldonline.com/feed/",name:"Solar Power World",reliable:!0},{url:"https://renewablesnow.com/rss/",name:"Renewables Now",reliable:!0},{url:"https://feeds.feedburner.com/PvMagazine-GlobalPvSolarWebsite",name:"PV Magazine",reliable:!0},{url:"https://www.utilitydive.com/feeds/renewable-energy/",name:"Utility Dive",reliable:!0}],te={solar:["https://images.unsplash.com/photo-1613665813446-82a78c468a1d?w=800&auto=format&fit=crop","https://images.unsplash.com/photo-1509391366360-2e959784a276?w=800&auto=format&fit=crop","https://images.pexels.com/photos/356036/pexels-photo-356036.jpeg?w=800&auto=format&fit=crop"],wind:["https://images.unsplash.com/photo-1466611653911-95081537e5b7?w=800&auto=format&fit=crop","https://images.unsplash.com/photo-1548337138-e87d889cc369?w=800&auto=format&fit=crop","https://images.pexels.com/photos/414837/pexels-photo-414837.jpeg?w=800&auto=format&fit=crop"],hydro:["https://images.unsplash.com/photo-1544964656-b557ba862fa3?w=800&auto=format&fit=crop","https://images.unsplash.com/photo-1623961993776-c23062bf31e8?w=800&auto=format&fit=crop","https://images.pexels.com/photos/2553401/pexels-photo-2553401.jpeg?w=800&auto=format&fit=crop"],geothermal:["https://images.unsplash.com/photo-1527669538566-7300c2a0475a?w=800&auto=format&fit=crop","https://images.unsplash.com/photo-1675181656581-e47ee01224f5?w=800&auto=format&fit=crop","https://images.pexels.com/photos/4993225/pexels-photo-4993225.jpeg?w=800&auto=format&fit=crop"],biomass:["https://images.unsplash.com/photo-1608042314453-ae338d80c427?w=800&auto=format&fit=crop","https://images.unsplash.com/photo-1518569656558-1f25fdc6d538?w=800&auto=format&fit=crop","https://images.pexels.com/photos/5546922/pexels-photo-5546922.jpeg?w=800&auto=format&fit=crop"],general:["https://images.unsplash.com/photo-1473341304170-971dccb5ac1e?w=800&auto=format&fit=crop","https://images.unsplash.com/photo-1508514177221-188b1cf16e9d?w=800&auto=format&fit=crop","https://images.pexels.com/photos/9875441/pexels-photo-9875441.jpeg?w=800&auto=format&fit=crop"]},me=["https://api.rss2json.com/v1/api.json?rss_url=","https://api.allorigins.win/raw?url=","https://corsproxy.io/?"],Be=()=>{const f=[];Object.values(te).forEach(E=>{E.forEach(D=>{f.push(D)})}),f.slice(0,10).forEach(E=>{const D=new Image;D.src=E})},_e=()=>{const[f,E]=g.useState([]),[D,z]=g.useState(!0),[_,J]=g.useState("all"),[v,H]=g.useState(!1),[d,G]=g.useState(null),[q,K]=g.useState(null),[V,U]=g.useState(null),[P,F]=g.useState({success:0,failed:0}),[X,ae]=g.useState(!1);g.useEffect(()=>{Be()},[]),g.useEffect(()=>{const t=localStorage.getItem("renewable-news-cache"),a=localStorage.getItem("renewable-news-timestamp"),n=new Date().getTime();if(t&&a&&n-parseInt(a)<3*60*60*1e3){E(JSON.parse(t)),U(new Date(parseInt(a))),z(!1),console.log("Using cached news data");return}N()},[]);const s=t=>{const a=te[t]||te.general;return a[Math.floor(Math.random()*a.length)]},o=t=>{if(!t)return!1;const a=["spacer.gif","pixel.gif","blank.gif","tracker","track.","counter.","count.","1x1.","logo_","favicon","icon-",".svg","button","banner","header","footer"],n=t.toLowerCase();return!(a.some(c=>n.includes(c))||![".jpg",".jpeg",".png",".gif",".webp"].some(c=>n.endsWith(c))&&!n.includes(".jpg?")&&!n.includes(".jpeg?")&&!n.includes(".png?")&&!n.includes(".webp?")&&!["cloudinary","cloudfront","imgix","unsplash","pexels","googleapis","wp-content"].some(W=>n.includes(W))||t.length<10)},m=t=>{var a;if(!t)return null;try{const r=new DOMParser().parseFromString(t,"text/html"),c=r.querySelector('meta[property="og:image"]');if(c&&c.getAttribute("content")){const l=c.getAttribute("content");if(o(l))return l}const i=Array.from(r.querySelectorAll("img")).filter(l=>{const u=l.getAttribute("src");if(!o(u))return!1;const y=parseInt(l.getAttribute("width")||"0"),S=parseInt(l.getAttribute("height")||"0");return!(y>0&&y<100||S>0&&S<100)}).sort((l,u)=>{const y=parseInt(l.getAttribute("width")||"0"),S=parseInt(l.getAttribute("height")||"0"),B=parseInt(u.getAttribute("width")||"0"),p=parseInt(u.getAttribute("height")||"0"),k=y*S;return B*p-k});if(i.length>0){let l=i[0].getAttribute("src");if(l.startsWith("/"))try{l=new URL(((a=t.match(/<link>([^<]+)<\/link>/))==null?void 0:a[1])||"").origin+l}catch{l="https://www.renewableenergyworld.com"+l}return l}}catch(n){console.error("Error parsing HTML for images:",n)}try{const n=/<img[^>]+src="([^">]+)"[^>]*>/g,r=[];let c;for(;(c=n.exec(t))!==null;)o(c[1])&&r.push(c[1]);return r.length>0?r[0]:null}catch(n){return console.error("Error with regex image extraction:",n),null}},h=t=>{var c,W,i,l;if((c=t.enclosure)!=null&&c.link&&o(t.enclosure.link))return t.enclosure.link;if((W=t.enclosure)!=null&&W.url&&o(t.enclosure.url))return t.enclosure.url;if(t.thumbnail&&o(t.thumbnail))return t.thumbnail;if((i=t["media:content"])!=null&&i.url&&o(t["media:content"].url))return t["media:content"].url;if((l=t["media:thumbnail"])!=null&&l.url&&o(t["media:thumbnail"].url))return t["media:thumbnail"].url;if(t.image){const u=typeof t.image=="string"?t.image:t.image.url||t.image.href;if(o(u))return u}const a=m(t.content);if(a)return a;const n=m(t.description);if(n)return n;const r=(t.title||"").toLowerCase();return r.includes("solar")||r.includes("photovoltaic")||r.includes("pv ")?s("solar"):r.includes("wind")||r.includes("turbine")?s("wind"):r.includes("hydro")||r.includes("dam")||r.includes("water power")?s("hydro"):r.includes("geothermal")||r.includes("heat pump")?s("geothermal"):r.includes("biomass")||r.includes("biofuel")||r.includes("biogas")?s("biomass"):null},x=async(t,a=0)=>{if(a>=me.length)throw new Error("All CORS proxies failed");try{const n=me[a]+encodeURIComponent(t),r=await fetch(n);if(!r.ok)throw new Error(`HTTP error: ${r.status}`);return await r.json()}catch{return console.warn(`CORS proxy ${a+1} failed, trying next...`),x(t,a+1)}},N=async()=>{z(!0),K(null),F({success:0,failed:0});try{let t=[];const a=de.filter(i=>i.reliable),n=de.filter(i=>!i.reliable),c=[...a,...n].map(i=>x(i.url).then(l=>(console.log(`Successfully fetched from ${i.name}`),l.status==="ok"&&l.items&&l.items.length>0?(X&&console.log(`Sample item structure from ${i.name}:`,JSON.stringify(l.items[0],null,2)),Promise.all(l.items.map(async(u,y)=>{const S=document.createElement("div");S.innerHTML=u.description||"";const B=S.textContent||S.innerText||"",p=(u.title+" "+B).toLowerCase();let k="general";p.includes("solar")||p.includes("photovoltaic")||p.includes("pv ")?k="solar":p.includes("wind")||p.includes("turbine")?k="wind":p.includes("hydro")||p.includes("hydroelectric")||p.includes("dam")||p.includes("water power")?k="hydro":p.includes("geothermal")||p.includes("heat pump")?k="geothermal":(p.includes("biomass")||p.includes("biofuel")||p.includes("biogas"))&&(k="biomass");let M=h(u);if(M)try{await new Promise((xe,fe)=>{const Q=new Image;Q.onload=()=>{F(Y=>({...Y,success:Y.success+1})),xe(!0)},Q.onerror=()=>{F(Y=>({...Y,failed:Y.failed+1})),fe(new Error("Image failed to load"))},Q.src=M})}catch{console.log(`Image failed to load: ${M}`),M=s(k)}else M=s(k);const ue=B.split(/\s+/).length,ge=Math.max(1,Math.min(15,Math.ceil(ue/200)));return{id:`${i.name}-${y}`,title:u.title,description:B.substring(0,500)+(B.length>500?"...":""),url:u.link,urlToImage:M,publishedAt:u.pubDate,source:{name:i.name},category:k,readTime:ge}}))):[])).catch(l=>(console.warn(`Error fetching from ${i.name}:`,l),[])));if((await Promise.all(c)).forEach(i=>{i&&i.length&&(t=[...t,...i])}),t.length>0){t.sort((y,S)=>new Date(S.publishedAt)-new Date(y.publishedAt));const i=[],l=new Set;t.forEach(y=>{l.has(y.title)||(l.add(y.title),i.push(y))}),console.log(`Successfully processed ${i.length} articles with ${P.success} valid images`),E(i);const u=new Date().getTime();localStorage.setItem("renewable-news-cache",JSON.stringify(i)),localStorage.setItem("renewable-news-timestamp",u.toString()),U(new Date(u))}else throw new Error("No articles found from any source")}catch(t){console.error("Error fetching renewable energy news:",t),K("Unable to load the latest renewable energy news. Please try again later."),f.length===0&&(E(b()),U(new Date))}finally{z(!1)}},O=(t="Renewable Energy",a="general")=>{var c;const n=((c=$[a])==null?void 0:c.replace("#",""))||"6366F1",r=encodeURIComponent(t);return`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='400' viewBox='0 0 800 400'%3E%3Crect width='800' height='400' fill='%23${n}'/%3E%3Ctext x='400' y='200' font-family='Arial' font-size='32' text-anchor='middle' fill='white'%3E${r}%3C/text%3E%3C/svg%3E`},b=()=>[{id:"fallback-1",title:"Solar Power Innovations Driving Renewable Energy Growth",description:"New advances in solar panel efficiency and battery storage are accelerating the transition to clean energy worldwide. Researchers have developed panels that can operate at higher efficiency rates even in low-light conditions, potentially extending solar viability to more regions.",urlToImage:s("solar"),publishedAt:new Date().toISOString(),source:{name:"Renewable Energy World"},url:"https://www.renewableenergyworld.com/",category:"solar",readTime:6},{id:"fallback-2",title:"Offshore Wind Projects Expand as Costs Decline",description:"Offshore wind is seeing unprecedented growth as technology improvements drive down costs. New floating turbine designs allow wind farms to be installed in deeper waters, opening up vast new areas for renewable energy development without visual impact on coastal communities.",urlToImage:s("wind"),publishedAt:new Date(Date.now()-864e5).toISOString(),source:{name:"CleanTechnica"},url:"https://cleantechnica.com/",category:"wind",readTime:5},{id:"fallback-3",title:"Hydropower Modernization Projects Boost Efficiency",description:"Aging hydroelectric dams are getting high-tech upgrades that significantly increase their power output without increasing their environmental footprint. New turbine designs, digital controls, and improved flow management are breathing new life into infrastructure that in some cases is over 50 years old.",urlToImage:s("hydro"),publishedAt:new Date(Date.now()-1728e5).toISOString(),source:{name:"Hydro Review"},url:"https://www.hydroreview.com/",category:"hydro",readTime:7},{id:"fallback-4",title:"Geothermal Power Plants Set for Major Expansion",description:"Geothermal energy is experiencing renewed interest as countries look to develop always-on renewable energy sources. Enhanced geothermal systems now allow power production in regions previously thought unsuitable for geothermal development, potentially making this stable clean energy source widely available.",urlToImage:s("geothermal"),publishedAt:new Date(Date.now()-2592e5).toISOString(),source:{name:"Renewable Energy World"},url:"https://www.renewableenergyworld.com/",category:"geothermal",readTime:8},{id:"fallback-5",title:"Biomass Industry Makes Progress on Sustainability Standards",description:"The biomass industry is introducing new sustainability certifications to address concerns about feedstock sourcing. These standards ensure that biomass energy production does not compete with food production or contribute to deforestation, focusing instead on agricultural waste and sustainable forestry practices.",urlToImage:s("biomass"),publishedAt:new Date(Date.now()-3456e5).toISOString(),source:{name:"Bioenergy Insight"},url:"https://www.bioenergy-news.com/",category:"biomass",readTime:6}],A=_==="all"?f:f.filter(t=>t.category===_),w=t=>{try{const a={year:"numeric",month:"short",day:"numeric"};return new Date(t).toLocaleDateString(void 0,a)}catch{return t}},j=t=>{try{const a=new Date,n=new Date(t),r=Math.floor((a-n)/1e3);return r<60?`${r} seconds ago`:r<3600?`${Math.floor(r/60)} minutes ago`:r<86400?`${Math.floor(r/3600)} hours ago`:r<604800?`${Math.floor(r/86400)} days ago`:w(t)}catch{return"recently"}},C=t=>{G(t),H(!0)},T=()=>{H(!1),setTimeout(()=>G(null),300)},I=()=>{N()},R=(t,a)=>{t.target.onerror=null;const n=s(a.category);if(n)t.target.src=n;else{const r=a.category.charAt(0).toUpperCase()+a.category.slice(1)+" Energy";t.target.src=O(r,a.category)}console.log(`Image replacement applied for article: ${a.title.substring(0,30)}...`)};return D?e.jsxs("div",{className:"mt-8",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Renewable Energy News"})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(t=>e.jsxs("div",{className:"animate-pulse rounded-lg overflow-hidden shadow-md bg-white",children:[e.jsx("div",{className:"h-40 bg-gray-200"}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-2"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4 mb-3"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-full mb-3"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]})]},t))})]}):e.jsxs("div",{className:"mt-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Renewable Energy News"}),e.jsxs("div",{className:"flex items-center gap-4",children:[V&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",j(V),e.jsx("button",{onClick:I,disabled:D,className:"ml-2 p-1 rounded-full hover:bg-gray-100 disabled:opacity-50",title:"Refresh now",children:e.jsx(ee,{size:14,className:`${D?"animate-spin":""}`})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["all","solar","wind","hydro","geothermal","biomass"].map(t=>e.jsx("button",{className:`px-3 py-1 text-sm rounded-full ${_===t?"bg-gray-800 text-white":"bg-gray-100 text-gray-800 hover:bg-gray-200"}`,onClick:()=>J(t),children:t.charAt(0).toUpperCase()+t.slice(1)},t))})]})]}),q&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 rounded-md p-4 mb-6",children:e.jsx("p",{children:q})}),A.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No articles found for this category. Try selecting a different category or refreshing the news."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:A.slice(0,9).map(t=>e.jsxs("div",{className:"rounded-lg overflow-hidden shadow-md bg-white hover:shadow-lg transition-shadow duration-300 cursor-pointer h-full flex flex-col",onClick:()=>C(t),children:[e.jsxs("div",{className:"h-40 bg-gray-200 relative",children:[t.urlToImage?e.jsx("img",{src:t.urlToImage,alt:t.title,className:"w-full h-full object-cover",onError:a=>R(a,t),loading:"lazy"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-center px-4",style:{backgroundColor:$[t.category]||$.general,color:"white"},children:e.jsxs("span",{className:"font-medium",children:[t.category.charAt(0).toUpperCase()+t.category.slice(1)," Energy"]})}),e.jsx("div",{className:"absolute top-3 left-3 px-2 py-1 rounded-full text-xs font-medium text-white",style:{backgroundColor:$[t.category]||$.general},children:t.category.charAt(0).toUpperCase()+t.category.slice(1)})]}),e.jsxs("div",{className:"p-4 flex-grow flex flex-col",children:[e.jsxs("div",{className:"flex items-center text-xs text-gray-500 mb-2",children:[e.jsx(re,{size:12,className:"mr-1"}),e.jsxs("span",{children:[t.readTime," min read"]}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{children:j(t.publishedAt)})]}),e.jsx("h3",{className:"font-semibold text-lg mb-2 line-clamp-2",children:t.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-3 flex-grow",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between mt-auto",children:[e.jsxs("span",{className:"text-xs text-gray-500 truncate max-w-[150px]",children:["Source: ",t.source.name]}),e.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Read more"})]})]})]},t.id))}),v&&d&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-hidden shadow-xl flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h3",{className:"font-semibold text-lg truncate pr-4",children:d.title}),e.jsx("button",{onClick:T,className:"p-1 rounded-full hover:bg-gray-100",children:e.jsx(Se,{size:20})})]}),e.jsxs("div",{className:"overflow-y-auto flex-grow p-4",children:[d.urlToImage&&e.jsx("div",{className:"mb-4",children:e.jsx("img",{src:d.urlToImage,alt:d.title,className:"w-full h-auto max-h-[400px] object-cover rounded",onError:t=>R(t,d)})}),e.jsxs("div",{className:"flex flex-wrap items-center text-sm text-gray-500 mb-4 gap-2",children:[e.jsx("span",{className:"font-medium",children:d.source.name}),e.jsx("span",{children:"•"}),e.jsx(re,{size:14,className:"mx-1"}),e.jsxs("span",{children:[d.readTime," min read"]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:w(d.publishedAt)}),e.jsx("div",{className:"px-2 py-1 rounded-full text-xs font-medium text-white ml-2",style:{backgroundColor:$[d.category]||$.general},children:d.category.charAt(0).toUpperCase()+d.category.slice(1)})]}),e.jsx("div",{className:"mt-4 mb-6",children:e.jsx("p",{className:"text-gray-800 whitespace-pre-line leading-relaxed",children:d.description})}),e.jsx("p",{className:"text-gray-600 italic mb-4 border-t pt-4 text-sm",children:"This is a preview. Visit the publisher's website to read the full article."})]}),e.jsxs("div",{className:"p-4 border-t flex justify-between items-center",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{className:"p-2 rounded-full hover:bg-gray-100",title:"Save article",children:e.jsx(ze,{size:18})}),e.jsx("button",{className:"p-2 rounded-full hover:bg-gray-100",title:"Share article",children:e.jsx(We,{size:18})})]}),e.jsxs("a",{href:d.url,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center",onClick:t=>t.stopPropagation(),children:["Read Full Article ",e.jsx(Fe,{size:16,className:"ml-2"})]})]})]})}),f.length>9&&e.jsx("div",{className:"text-center mt-6",children:e.jsxs("button",{className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:["Load More News ",e.jsx(ee,{size:16,className:"ml-2"})]})}),X&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-100 rounded-lg text-xs",children:[e.jsx("h4",{className:"font-semibold",children:"Debug Info:"}),e.jsxs("p",{children:["Images loaded successfully: ",P.success]}),e.jsxs("p",{children:["Images failed to load: ",P.failed]}),e.jsxs("p",{children:["Using fallback images: ",P.failed>0?"Yes":"No"]})]})]})},L=[{type:"solar",icon:we,color:"#FFB800",name:"Solar",endpoint:"/api/predictions/solar/"},{type:"hydro",icon:ke,color:"#2E90E5",name:"Hydro",endpoint:"/api/predictions/hydro/"},{type:"wind",icon:ye,color:"#64748B",name:"Wind",endpoint:"/api/predictions/wind/"},{type:"biomass",icon:Ee,color:"#16A34A",name:"Biomass",endpoint:"/api/predictions/biomass/"},{type:"geothermal",icon:De,color:"#FF6B6B",name:"Geothermal",endpoint:"/api/predictions/geothermal/"}],he="http://127.0.0.1:8000",rt=()=>{const[f,E]=g.useState({}),[D,z]=g.useState(!0),[_,J]=g.useState(0),[v,H]=g.useState(2030),[d,G]=g.useState([]),[q,K]=g.useState(!1),V=g.useRef(null);g.useEffect(()=>{U()},[v]);const U=async()=>{var N,O;z(!0),G([]);const s={};let o=0,m=[],h=!1;const x=be.create({baseURL:he,timeout:1e4});for(const{type:b,endpoint:A}of L)try{console.log(`Fetching from: ${he}${A}?start_year=2025&end_year=2030`);const w=await x.get(A,{params:{start_year:2025,end_year:2030}});if(console.log(`Response for ${b}:`,w.data),w.data&&w.data.predictions){const j=w.data.predictions,C=j.map(t=>({date:Number(t.Year),value:Math.abs(Number(t["Predicted Production"]))})),T=j.find(t=>Number(t.Year)===v),I=T?Math.abs(Number(T["Predicted Production"])):j[j.length-1]?Math.abs(Number(j[j.length-1]["Predicted Production"])):0;o+=I;const R=j.reduce((t,a)=>(t[Number(a.Year)]=Math.abs(Number(a["Predicted Production"])),t),{});s[b]={generationData:C,currentProjection:I,yearlyData:R}}else throw console.error(`Unexpected response format for ${b}:`,w.data),new Error(`Invalid data structure from ${b} API`)}catch(w){console.error(`Error fetching ${b} data:`,w),m.push(b),h=!0;const C=ve(b).getState().generateMockData(2025,2030),T=((N=C.find(I=>I.date===v))==null?void 0:N.value)||((O=C[C.length-1])==null?void 0:O.value)||0;o+=T,s[b]={generationData:C,currentProjection:T,yearlyData:C.reduce((I,R)=>(I[R.date]=R.value,I),{})}}E(s),J(Math.round(o*10)/10),G(m),K(h),z(!1)},P=()=>L.map(({type:s,name:o,color:m})=>{var h;return{name:o,value:((h=f[s])==null?void 0:h.currentProjection)||0,color:m}}),F=()=>L.map(({type:s,name:o,color:m})=>{var x;const h=((x=f[s])==null?void 0:x.yearlyData)||{};return{name:o,value:h[v]||0,color:m}}).sort((s,o)=>o.value-s.value),X=()=>{const s=[];for(let o=2025;o<=2030;o++)s.push(o);return s.map(o=>{const m={year:o};return L.forEach(({type:h})=>{var N;const x=((N=f[h])==null?void 0:N.yearlyData)||{};m[h]=x[o]||0}),m})},ae=()=>{U()};return D?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center py-10",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-gray-900"}),e.jsx("p",{className:"mt-4 text-gray-700",children:"Loading dashboard data..."})]})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Energy Dashboard"}),e.jsxs("div",{className:"text-gray-500 flex items-center",children:[e.jsxs("div",{className:"text-sm font-medium mr-3",children:["Projection Year: ",v]}),q&&e.jsxs("div",{className:"text-amber-600 text-xs flex items-center bg-amber-50 px-2 py-1 rounded",children:[e.jsx(oe,{size:14,className:"mr-1"}),"Using simulation data for some sources"]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"flex space-x-2",children:[2025,2026,2027,2028,2029,2030].map(s=>e.jsx("button",{className:`px-3 py-1 rounded ${v===s?"bg-gray-800 text-white":"bg-gray-100 text-gray-800 hover:bg-gray-200"}`,onClick:()=>H(s),children:s},s))}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{className:"flex items-center px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 transition-colors",onClick:ae,children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Refresh Data"]})})]})]}),d.length>0&&e.jsx("div",{className:"mb-6 bg-amber-50 border border-amber-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(oe,{className:"h-5 w-5 text-amber-600 mr-2"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-amber-800",children:"Unable to fetch data from some sources"}),e.jsxs("p",{className:"mt-1 text-sm text-amber-700",children:["Using simulation data for ",d.join(", "),". Real-time data may not be available."]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"rounded-lg p-6 bg-gradient-to-br from-gray-800 to-gray-900 text-white shadow-md",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-300",children:"Total Energy Generation"}),e.jsxs("div",{className:"text-4xl font-bold mb-2",children:[_," GWh"]}),e.jsxs("p",{className:"text-gray-300",children:["Combined projection for ",v]})]}),e.jsxs("div",{className:"rounded-lg p-6 bg-white shadow-md",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Energy Distribution"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex flex-col space-y-2",children:L.map(({type:s,name:o,icon:m,color:h})=>{var x;return e.jsxs("div",{className:"flex items-center",children:[e.jsx(m,{size:16,style:{color:h},className:"mr-2"}),e.jsxs("span",{className:"text-gray-700 text-sm mr-2",children:[o,":"]}),e.jsxs("span",{className:"font-medium",children:[Math.round((((x=f[s])==null?void 0:x.currentProjection)||0)*10)/10," GWh"]}),d.includes(s)&&e.jsx("span",{className:"ml-1 text-xs text-amber-600",children:"(sim)"})]},s)})}),e.jsx("div",{className:"w-24 h-24",children:e.jsx(Z,{width:"100%",height:"100%",children:e.jsx(Te,{children:e.jsx(Re,{data:P(),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:36,innerRadius:20,children:P().map((s,o)=>e.jsx(Ae,{fill:s.color},`cell-${o}`))})})})})]})]}),e.jsxs("div",{className:"rounded-lg p-6 bg-white shadow-md border-l-4 border-green-500",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 text-gray-800 flex items-center justify-between",children:[e.jsx("span",{children:"Top Performers"}),e.jsx(Me,{size:16,className:"text-gray-500"})]}),e.jsx("div",{className:"space-y-3",children:F().slice(0,3).map((s,o)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-1 h-10 mr-3 rounded-full",style:{backgroundColor:s.color}}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium",children:s.name}),e.jsxs("span",{className:"text-sm font-bold",children:[Math.round(s.value*10)/10," GWh"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"h-2 rounded-full",style:{width:`${s.value/F()[0].value*100}%`,backgroundColor:s.color}})})]})]},o))})]})]}),e.jsxs("div",{className:"rounded-lg p-6 bg-white shadow-md mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-800",children:"Energy Generation Trends"}),e.jsx("div",{className:"h-[300px]",ref:V,children:e.jsx(Z,{width:"100%",height:"100%",children:e.jsxs(ne,{data:X(),children:[e.jsx(Ce,{strokeDasharray:"3 3",vertical:!1,stroke:"#e5e7eb"}),e.jsx(ie,{dataKey:"year"}),e.jsx(Ie,{}),e.jsx(ce,{}),e.jsx(Pe,{}),L.map(({type:s,name:o,color:m})=>e.jsx(le,{type:"monotone",dataKey:s,name:o,stroke:m,fill:m,fillOpacity:.2,stackId:"1"},s))]})})})]}),e.jsx(_e,{}),e.jsx("h2",{className:"text-xl font-semibold mb-4 mt-8 text-gray-800",children:"Energy Sources Overview"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:L.map(({type:s,name:o,icon:m,color:h})=>{const x=f[s]||{},N=Ne(s),O=d.includes(s),b={borderLeft:`4px solid ${h}`};return e.jsxs("div",{className:"rounded-lg p-6 bg-white shadow-md relative",style:b,children:[e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx(je,{to:`/${s}`,children:e.jsx("button",{className:"w-8 h-8 p-0 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center",children:e.jsx($e,{size:14,className:"text-gray-700"})})})}),e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(m,{size:20,style:{color:h},className:"mr-2"}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:[o," Energy",O&&e.jsx("span",{className:"ml-2 text-xs text-amber-600 font-normal",children:"(simulated data)"})]})]}),e.jsxs("div",{className:"text-2xl font-bold mb-1",style:{color:h},children:[Math.round((x.currentProjection||0)*10)/10," GWh"]}),e.jsxs("p",{className:"text-gray-600 text-sm mb-4",children:["Projected for ",v]}),e.jsx("div",{className:"h-[120px]",children:e.jsx(Z,{width:"100%",height:"100%",children:e.jsxs(ne,{data:x.generationData||[],children:[e.jsx("defs",{children:e.jsx("linearGradient",{id:`${s}Gradient`,x1:"0",y1:"0",x2:"0",y2:"1",children:N.gradient.stops.map((A,w)=>e.jsx("stop",{offset:A.offset,stopColor:A.color,stopOpacity:A.opacity},w))})}),e.jsx(ie,{dataKey:"date",tick:{fontSize:10},tickLine:!1,axisLine:!1}),e.jsx(ce,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"6px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",fontSize:"12px"}}),e.jsx(le,{type:"monotone",dataKey:"value",stroke:h,fill:`url(#${s}Gradient)`,strokeWidth:2})]})})})]},s)})})]})};export{rt as default};
