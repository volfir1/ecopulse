import{k as f,b as A,e as F,r as l,j as e,T as s,bD as C,h as E,a as D,an as g,R,a8 as b,E as T}from"./index-CeiZKB8G.js";import{t as j}from"./ticketService-PgP5Vb-h.js";import{R as W}from"./refresh-cw-DlOnahB6.js";import{C as P}from"./Chip-D2qSxnvf.js";import{A as S}from"./arrow-up-right-Cf_PwKT_.js";/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],M=f("ArrowDownRight",z);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],L=f("Users",U),H=()=>{const x=A(),{enqueueSnackbar:u}=F(),[p,v]=l.useState(!0),[t,y]=l.useState({tickets:{total:0,open:0,inProgress:0,resolved:0,closed:0,unassigned:0},resolution:{rate:0,change:0}}),[h,k]=l.useState([]);l.useEffect(()=>{(async()=>{v(!0);try{const r=await j.getTicketStats();r.data&&y(n=>({...n,tickets:{total:r.data.total||0,open:r.data.open||0,inProgress:r.data.inProgress||0,resolved:r.data.resolved||0,closed:r.data.closed||0,unassigned:r.data.unassigned||0}}));const i=await j.getAllTickets();k(i.data.slice(0,5))}catch(r){console.error("Error fetching dashboard data:",r),u("Failed to load dashboard data",{variant:"error"})}finally{v(!1)}})()},[u]);const N=a=>{switch(a){case"open":return{bg:"#EEF7FF",color:"#1A73E8"};case"in-progress":return{bg:"#FFF7E0",color:"#F29D41"};case"resolved":return{bg:"#E7F7ED",color:"#34A853"};case"closed":return{bg:"#F2F2F2",color:"#5F6368"};default:return{bg:"#F2F2F2",color:"#5F6368"}}},w=a=>{const r=new Date(a);return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(r)},m=({title:a,value:r,icon:i,iconBg:n,iconColor:d,changeValue:o,changeType:c})=>e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 h-full",children:e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx(s,{variant:"body2",color:"text.secondary",className:"mb-1",children:a}),e.jsx(s,{variant:"h5",fontWeight:"bold",children:r}),o&&e.jsxs("div",{className:"flex items-center mt-1",children:[c==="increase"?e.jsx(S,{size:16,className:"text-green-500 mr-1"}):e.jsx(M,{size:16,className:"text-red-500 mr-1"}),e.jsxs(s,{variant:"caption",color:c==="increase"?"success.main":"error.main",children:[o,"%"]})]})]}),e.jsx(b,{sx:{backgroundColor:n,color:d,width:40,height:40},children:i})]})});return p?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx(W,{className:"animate-spin text-blue-600",size:40})}):e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx(s,{variant:"h4",fontWeight:"bold",color:"text.primary",children:"User Tickets"}),e.jsx(s,{variant:"body1",color:"text.secondary",children:"Manage support ticket metrics and activity"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(m,{title:"Total Tickets",value:t.tickets.total,icon:e.jsx(C,{size:20}),iconBg:"rgba(21, 101, 192, 0.1)",iconColor:"#1565C0"}),e.jsx(m,{title:"Open Tickets",value:t.tickets.open,icon:e.jsx(E,{size:20}),iconBg:"rgba(26, 115, 232, 0.1)",iconColor:"#1A73E8"}),e.jsx(m,{title:"Unassigned",value:t.tickets.unassigned,icon:e.jsx(L,{size:20}),iconBg:"rgba(229, 57, 53, 0.1)",iconColor:"#E53935"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 h-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx(s,{variant:"h6",fontWeight:"bold",children:"Tickets by Status"}),e.jsx(D,{variant:"outlined",size:"small",onClick:()=>x("/admin/ticket"),children:"View All"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[e.jsx(s,{variant:"h5",fontWeight:"bold",color:"#1A73E8",children:t.tickets.open}),e.jsx(s,{variant:"body2",color:"#1A73E8",children:"Open"})]}),e.jsxs("div",{className:"bg-amber-50 rounded-lg p-4 text-center",children:[e.jsx(s,{variant:"h5",fontWeight:"bold",color:"#F29D41",children:t.tickets.inProgress}),e.jsx(s,{variant:"body2",color:"#F29D41",children:"In Progress"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[e.jsx(s,{variant:"h5",fontWeight:"bold",color:"#34A853",children:t.tickets.resolved}),e.jsx(s,{variant:"body2",color:"#34A853",children:"Resolved"})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-4 text-center",children:[e.jsx(s,{variant:"h5",fontWeight:"bold",color:"#E53935",children:t.tickets.unassigned}),e.jsx(s,{variant:"body2",color:"#E53935",children:"Unassigned"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx(s,{variant:"body2",fontWeight:"medium",children:"Open Tickets"}),e.jsxs(s,{variant:"body2",fontWeight:"medium",children:[t.tickets.open," / ",t.tickets.total]})]}),e.jsx(g,{variant:"determinate",value:t.tickets.open/t.tickets.total*100,sx:{height:8,borderRadius:4,backgroundColor:"rgba(26, 115, 232, 0.1)","& .MuiLinearProgress-bar":{backgroundColor:"#1A73E8"}}})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx(s,{variant:"body2",fontWeight:"medium",children:"In Progress Tickets"}),e.jsxs(s,{variant:"body2",fontWeight:"medium",children:[t.tickets.inProgress," / ",t.tickets.total]})]}),e.jsx(g,{variant:"determinate",value:t.tickets.inProgress/t.tickets.total*100,sx:{height:8,borderRadius:4,backgroundColor:"rgba(242, 157, 65, 0.1)","& .MuiLinearProgress-bar":{backgroundColor:"#F29D41"}}})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx(s,{variant:"body2",fontWeight:"medium",children:"Resolved Tickets"}),e.jsxs(s,{variant:"body2",fontWeight:"medium",children:[t.tickets.resolved," / ",t.tickets.total]})]}),e.jsx(g,{variant:"determinate",value:t.tickets.resolved/t.tickets.total*100,sx:{height:8,borderRadius:4,backgroundColor:"rgba(52, 168, 83, 0.1)","& .MuiLinearProgress-bar":{backgroundColor:"#34A853"}}})]})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 h-full",children:[e.jsx(s,{variant:"h6",fontWeight:"bold",className:"mb-4",children:"Recent Activity"}),h.length>0?e.jsx("div",{className:"space-y-1",children:h.map((a,r)=>{var i,n,d,o,c;return e.jsxs(R.Fragment,{children:[e.jsxs("div",{className:"py-3 flex items-start hover:bg-gray-50 rounded-md px-2 transition-colors cursor-pointer",onClick:()=>x(`/admin/tickets/${a._id}`),children:[e.jsx(b,{src:(i=a.user)==null?void 0:i.profilePicture,className:"mr-3",sx:{width:36,height:36},children:((d=(n=a.user)==null?void 0:n.firstName)==null?void 0:d.charAt(0))||((c=(o=a.user)==null?void 0:o.email)==null?void 0:c.charAt(0))}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx(s,{variant:"body2",fontWeight:"medium",noWrap:!0,className:"max-w-full",children:a.subject}),e.jsx(P,{label:a.status.replace("-"," "),size:"small",sx:{...N(a.status),textTransform:"capitalize",fontWeight:"medium",fontSize:"0.65rem",height:20}})]}),e.jsx(s,{variant:"caption",color:"text.secondary",children:w(a.updatedAt)})]})]}),r<h.length-1&&e.jsx(T,{})]},a._id)})}):e.jsx("div",{className:"flex justify-center items-center py-10",children:e.jsx(s,{variant:"body2",color:"text.secondary",children:"No recent activity"})})]})})]})]})};export{H as default};
