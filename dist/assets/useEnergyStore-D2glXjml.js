import{aa as q,ab as K,c as G}from"./index-D-CDyacC.js";import{a as V}from"./api-DsXL_j3W.js";import{E as J,h as Q}from"./html2canvas.esm-U_lmfmWK.js";const y={solar:{primaryColor:"#FFB800",secondaryColor:"#FFCD49",gradientOpacity:{start:.2,end:0},downloadFileName:"Solar_Power_Generation_Summary.pdf"},hydro:{primaryColor:"#2E90E5",secondaryColor:"#4FA2EA",gradientOpacity:{start:.3,end:0},downloadFileName:"Hydro_Power_Generation_Summary.pdf"},wind:{primaryColor:"#64748B",secondaryColor:"#94A3B8",gradientOpacity:{start:.25,end:0},downloadFileName:"Wind_Power_Generation_Summary.pdf"},biomass:{primaryColor:"#16A34A",secondaryColor:"#22C55E",gradientOpacity:{start:.2,end:.05},downloadFileName:"Biomass_Power_Generation_Summary.pdf"},geothermal:{primaryColor:"#FF6B6B",secondaryColor:"#FF9E9E",gradientOpacity:{start:.2,end:0},downloadFileName:"Geothermal_Power_Generation_Summary.pdf"}},{text:p,background:Z,divider:ee}=q.palette,le=(n="solar")=>{const m=y[n]||y.solar;return{gradient:{id:`${n}Gradient`,stops:[{offset:"5%",color:m.secondaryColor,opacity:m.gradientOpacity.start},{offset:"95%",color:m.secondaryColor,opacity:m.gradientOpacity.end}]},area:{type:"monotone",dataKey:"value",stroke:m.primaryColor,fill:`url(#${n}Gradient)`,strokeWidth:2,dot:{r:4,fill:m.primaryColor,strokeWidth:2,stroke:"#FFFFFF"},activeDot:{r:6,fill:m.primaryColor,stroke:"#FFFFFF",strokeWidth:2}},tooltip:{contentStyle:{backgroundColor:Z.paper,border:`1px solid ${ee}`,borderRadius:"6px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}}}},se=()=>({cartesianGrid:{strokeDasharray:"3 3",vertical:!1,stroke:"#e5e7eb"},xAxis:{stroke:p.secondary,tickLine:!0,fontSize:12,tickMargin:12,tick:{fill:p.secondary}},yAxis:{stroke:p.secondary,tickLine:!0,fontSize:12,tickMargin:12,tick:{fill:p.secondary}}}),ce=(n="solar")=>y[n]||y.solar,te="/assets/tup_logo-BfP1Eq4c.png",de=n=>{const m={solar:{color:"#FFB800",endpoint:"/api/predictions/solar/",fileName:"Solar_Power_Generation_Summary.pdf",title:"Solar Power Generation Chart",tableTitle:"Solar Power Generation Data Table",recommendations:["Invest in additional solar panel infrastructure to capitalize on the projected growth trend.","Develop energy storage solutions to address intermittency challenges.","Evaluate technological upgrades to improve solar capture efficiency.","Consider strategic placement of new solar installations based on irradiance data."],pdfStyles:{fillColor:[255,180,0],lightFill:[252,248,227]}},hydro:{color:"#2E90E5",endpoint:"/api/predictions/hydro/",fileName:"Hydropower_Generation_Summary.pdf",title:"Hydropower Generation Chart",tableTitle:"Hydropower Generation Data Table",recommendations:["Implement advanced water flow monitoring systems to optimize reservoir management.","Invest in turbine efficiency upgrades to increase power output during peak seasons.","Develop comprehensive drought contingency plans for low-water periods.","Explore hybrid renewable integration to balance seasonal hydropower fluctuations."],pdfStyles:{fillColor:[46,144,229],lightFill:[235,245,255]}},wind:{color:"#64748B",endpoint:"/api/predictions/wind/",fileName:"Wind_Power_Generation_Summary.pdf",title:"Wind Power Generation Chart",tableTitle:"Wind Power Generation Data Table",recommendations:["Invest in advanced turbine technology to improve efficiency in varying wind conditions.","Develop more sophisticated wind forecasting systems to optimize generation scheduling.","Implement smart grid integration to better manage intermittency challenges.","Explore hybrid wind-storage solutions to enhance reliability and grid stability."],pdfStyles:{fillColor:[100,116,139],lightFill:[240,244,248]}},biomass:{color:"#16A34A",endpoint:"/api/predictions/biomass/",fileName:"Biomass_Power_Generation_Summary.pdf",title:"Biomass Generation Chart",tableTitle:"Biomass Generation Data Table",recommendations:["Invest in additional processing capacity to handle the projected increase.","Develop partnerships with agricultural suppliers to ensure consistent feedstock availability.","Evaluate efficiency improvements to current generation facilities.","Consider expanding storage capabilities to manage seasonal fluctuations."],pdfStyles:{fillColor:[22,163,74],lightFill:[240,248,240]}},geothermal:{color:"#FF6B6B",endpoint:"/api/predictions/geothermal/",fileName:"Geothermal_Power_Generation_Summary.pdf",title:"Geothermal Generation Chart",tableTitle:"Geothermal Generation Data Table",recommendations:["Optimize well management and resource extraction to maximize long-term sustainability.","Implement advanced heat exchange technologies to increase efficiency.","Develop enhanced geothermal systems (EGS) for areas with lower natural temperatures.","Explore cascade applications to utilize residual heat in multiple processes."],pdfStyles:{fillColor:[255,107,107],lightFill:[255,235,235]}}},S=m[n]||m.solar;return K((g,l)=>({energyType:n,config:S,generationData:[],currentProjection:null,loading:!0,selectedStartYear:2025,selectedEndYear:2030,chartRef:null,additionalData:{},apiError:null,setChartRef:r=>g({chartRef:r}),setYearRange:(r,t)=>{g({selectedStartYear:r,selectedEndYear:t,apiError:null}),l().fetchData(r,t)},fetchData:async(r,t)=>{var h,s,u;g({loading:!0,apiError:null});try{const c=await V.get(`${S.endpoint}?start_year=${r}&end_year=${t}`);if(!((h=c==null?void 0:c.data)!=null&&h.predictions))throw new Error("No predictions data available");const o=c.data.predictions.map(e=>({date:e.Year,value:Math.abs(e["Predicted Production"])})),f=((s=o[o.length-1])==null?void 0:s.value)||null;g({generationData:o,currentProjection:f,loading:!1,apiError:null})}catch(c){console.error(`Error fetching ${n} data:`,c);const o=l().generateMockData(r,t);g({generationData:o,currentProjection:((u=o[o.length-1])==null?void 0:u.value)||null,loading:!1,apiError:{message:"Using simulated data",usingMockData:!0}})}},generateMockData:(r,t)=>{const h=[];for(let s=r;s<=t;s++)h.push(s);return h.map(s=>{const u=75+s%10*8,c=Math.sin(s*.5)*15;let o=1;n==="solar"&&(o=1.2),n==="wind"&&(o=1.1),n==="hydro"&&(o=.95),n==="biomass"&&(o=.85),n==="geothermal"&&(o=1.05);const f=(s-r)*2.5,e=(u+c+f)*o;return{date:s,value:parseFloat(e.toFixed(2))}})},generateMockAdditionalData:()=>n==="solar"?{irradianceData:l().getSolarIrradianceData(),panelPerformance:l().getPanelPerformance()}:n==="hydro"?{waterFlowData:l().getWaterFlowData(),turbineEfficiency:l().getTurbineEfficiency()}:n==="wind"?{windSpeedData:l().getWindSpeedData(),turbinePerformance:l().getTurbinePerformance()}:n==="biomass"?{feedstockData:l().getFeedstockData(),efficiencyData:l().getEfficiencyData()}:n==="geothermal"?{temperatureData:l().getTemperatureData(),wellPerformance:l().getWellPerformance()}:{},initialize:()=>{const{selectedStartYear:r,selectedEndYear:t,fetchData:h}=l();h(r,t)},getSolarIrradianceData:()=>Array.from({length:7},(r,t)=>({day:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][t],irradiance:800+Math.sin(t*.8)*200+Math.random()*100,power:4200+Math.sin(t*.8)*800+Math.random()*400})),getPanelPerformance:()=>Array.from({length:6},(r,t)=>({array:`Array ${t+1}`,efficiency:95+Math.sin(t*.5)*3+Math.random()*2,output:2500+Math.sin(t*.5)*300+Math.random()*200})),getWaterFlowData:()=>Array.from({length:7},(r,t)=>({day:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][t],flow:4200+Math.sin(t*.8)*800+Math.random()*400,generation:3800+Math.sin(t*.8)*600+Math.random()*300})),getTurbineEfficiency:()=>Array.from({length:8},(r,t)=>({turbine:`T${t+1}`,efficiency:85+Math.sin(t*.5)*10+Math.random()*5,output:2800+Math.sin(t*.7)*400+Math.random()*200})),getWindSpeedData:()=>Array.from({length:7},(r,t)=>({day:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][t],speed:15+Math.sin(t*.8)*5+Math.random()*3,power:3500+Math.sin(t*.8)*800+Math.random()*500})),getTurbinePerformance:()=>Array.from({length:6},(r,t)=>({turbine:`Turbine ${t+1}`,efficiency:92+Math.sin(t*.7)*5+Math.random()*3,output:2200+Math.sin(t*.6)*400+Math.random()*200})),getFeedstockData:()=>Array.from({length:7},(r,t)=>({day:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][t],agricultural:2800+Math.sin(t*.8)*500+Math.random()*300,forestry:2200+Math.cos(t*.8)*400+Math.random()*250})),getEfficiencyData:()=>Array.from({length:6},(r,t)=>({source:["Wood","Crop","Waste","Biogas","Pellets","Other"][t],efficiency:75+Math.sin(t*.7)*15+Math.random()*10,output:2400+Math.sin(t*.6)*500+Math.random()*300})),getTemperatureData:()=>Array.from({length:7},(r,t)=>({day:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][t],temperature:220+Math.sin(t*.3)*30+Math.random()*15,output:3200+Math.sin(t*.3)*500+Math.random()*250})),getWellPerformance:()=>Array.from({length:5},(r,t)=>({well:`Well ${t+1}`,temperature:240+Math.sin(t*.6)*40+Math.random()*20,pressure:85+Math.sin(t*.4)*10+Math.random()*5,output:2600+Math.sin(t*.5)*400+Math.random()*300})),handleDownload:async r=>{const{generationData:t,selectedStartYear:h,selectedEndYear:s,currentProjection:u,chartRef:c,config:o,apiError:f}=l();f&&f.usingMockData&&r&&typeof r.warning=="function"&&r.warning("Note: Using simulated data for this report as actual data could not be retrieved.");try{r&&typeof r.info=="function"&&r.info("Preparing your download...");const e=new J({orientation:"portrait",unit:"mm",format:"a4"}),i=e.internal.pageSize.getWidth(),w=e.internal.pageSize.getHeight(),b=30;e.setFillColor(...o.pdfStyles.fillColor),e.rect(0,0,i,b,"F"),e.addImage(G,"PNG",15,5,20,20),e.addImage(te,"PNG",i-35,5,20,20),e.setTextColor(255,255,255),e.setFontSize(16);const C="Ecopulse",z=e.getStringUnitWidth(C)*e.internal.getFontSize()/e.internal.scaleFactor,k=(i-z)/2;e.text(C,k,17),e.setFontSize(11);const M=`Date Generated: ${new Date().toLocaleDateString()}`,A=e.getStringUnitWidth(M)*e.internal.getFontSize()/e.internal.scaleFactor,N=(i-A)/2;e.text(M,N,25),e.setTextColor(0,0,0);let a=b+15;e.setFontSize(12);const D=`Year Range: ${h} - ${s}`,$=e.getStringUnitWidth(D)*e.internal.getFontSize()/e.internal.scaleFactor,B=(i-$)/2;e.text(D,B,a),a+=8;const x=`Current Projection: ${u?u.toFixed(2):"N/A"} GWh`,I=e.getStringUnitWidth(x)*e.internal.getFontSize()/e.internal.scaleFactor,R=(i-I)/2;if(e.text(x,R,a),a+=15,f&&f.usingMockData){e.setFontSize(10),e.setTextColor(192,0,0);const d="Note: Using simulated data for this report",E=e.getStringUnitWidth(d)*e.internal.getFontSize()/e.internal.scaleFactor,F=(i-E)/2;e.text(d,F,a),e.setTextColor(0,0,0),a+=10}if(c&&c.current)try{const d=c.current,F=(await Q(d,{scale:2,useCORS:!0,logging:!1})).toDataURL("image/png");e.setFontSize(14);const _=o.title,X=e.getStringUnitWidth(_)*e.internal.getFontSize()/e.internal.scaleFactor,L=(i-X)/2;e.text(_,L,a),a+=8;const T=180,H=(i-T)/2;e.addImage(F,"PNG",H,a,T,90),a+=100}catch(d){console.error("Error capturing chart:",d)}else a+=10;e.setFontSize(14);const P=o.tableTitle,O=e.getStringUnitWidth(P)*e.internal.getFontSize()/e.internal.scaleFactor,j=(i-O)/2;e.text(P,j,a),a+=8,e.autoTable({head:[["Year","Predicted Production (GWh)"]],body:t.map(d=>[d.date,d.value.toFixed(2)]),startY:a,margin:{left:30,right:30},headStyles:{fillColor:o.pdfStyles.fillColor,halign:"center",fontSize:11},columnStyles:{0:{cellWidth:60,halign:"center"},1:{cellWidth:100,halign:"center"}},styles:{fontSize:10,cellPadding:5,overflow:"linebreak"},alternateRowStyles:{fillColor:o.pdfStyles.lightFill}}),a=e.autoTable.previous.finalY+15,a>w-140&&(e.addPage(),a=20),e.setFillColor(...o.pdfStyles.fillColor),e.rect(15,a,i-30,20,"F"),e.setTextColor(255,255,255),e.setFontSize(12),e.setFont(void 0,"bold"),e.text("RECOMMENDATIONS",i/2,a+13,{align:"center"}),e.setFont(void 0,"normal"),e.setTextColor(0,0,0),a+=25,e.setDrawColor(...o.pdfStyles.fillColor),e.setLineWidth(.5),e.line(15,a,i-15,a),a+=10,e.setFontSize(9),e.setFont(void 0,"italic"),e.text(`Based on the projected increase in ${n} power generation, we recommend:`,20,a),e.setFont(void 0,"normal"),a+=10,o.recommendations.forEach(d=>{e.setFillColor(...o.pdfStyles.fillColor),e.circle(20,a-1,2,"F"),e.setFontSize(9),e.text(d,25,a),a+=8}),a+=7,e.setDrawColor(...o.pdfStyles.fillColor),e.setLineWidth(.5),e.line(15,a,i-15,a),a+=7,e.setFontSize(8),e.setFont(void 0,"bold"),e.text("Sources:",20,a),e.setFont(void 0,"normal");const v=(i-40)/2;e.text(`1. Placeholder source for ${n} data`,20,a+7),e.text("2. Placeholder source for prediction models",20,a+14),e.text("3. Placeholder source for efficiency calculation",20+v,a+7),e.text("4. Placeholder source for energy conversion factors",20+v,a+14),e.addImage(G,"PNG",i-25,a+5,15,15),e.setFontSize(7);const W=`© ${new Date().getFullYear()} Ecopulse. All rights reserved.`,U=e.getStringUnitWidth(W)*e.internal.getFontSize()/e.internal.scaleFactor,Y=(i-U)/2;return e.text(W,Y,a+22),a>w-30&&e.addPage(),e.save(o.fileName),r&&typeof r.success=="function"&&r.success("Summary downloaded successfully!"),{success:!0}}catch(e){return console.error("Download error:",e),r&&typeof r.error=="function"&&r.error("Failed to download summary. Please try again."),{success:!1,error:e}}}}))};export{se as a,ce as b,de as c,le as g};
