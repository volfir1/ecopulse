import{r as t,b as z,d as R,j as e,f as M}from"./index-D-CDyacC.js";const C=()=>{const[l,j]=t.useState(""),[c,N]=t.useState(""),[i,y]=t.useState(""),[d,m]=t.useState(!1),[x,u]=t.useState(""),[h,o]=t.useState(""),[g,w]=t.useState(""),[s,b]=t.useState({length:!1,uppercase:!1,lowercase:!1,number:!1,special:!1}),p=z(),f=R();t.useEffect(()=>{const r=new URLSearchParams(f.search).get("token");r?y(r):o("Invalid or missing reset token. Please request a new password reset link.")},[f]),t.useEffect(()=>{v(l)},[l]);const v=a=>{const r={length:a.length>=8,uppercase:/[A-Z]/.test(a),lowercase:/[a-z]/.test(a),number:/[0-9]/.test(a),special:/[^A-Za-z0-9]/.test(a)};return b(r),r.length?"":"Password must be at least 8 characters long"},P=async a=>{if(a.preventDefault(),o(""),w(""),u(""),!i){o("Missing reset token. Please request a new password reset link.");return}if(l!==c){o("Passwords do not match");return}const r=v(l);if(r){w(r);return}m(!0);try{const n=await M.resetPassword(i,l);u(n.message||"Password reset successful!"),n.accessToken?(localStorage.setItem("authToken",n.accessToken),setTimeout(()=>p("/dashboard"),2e3)):setTimeout(()=>p("/login"),2e3)}catch(n){o(n.message||"Failed to reset password. Please try again."),console.error("Reset password error:",n)}finally{m(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-lg shadow-md",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"Reset Your Password"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Please create a strong password for your account"})]}),x&&e.jsx("div",{className:"rounded-md bg-green-50 p-4 mb-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-green-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-green-800",children:x})})]})}),h&&e.jsx("div",{className:"rounded-md bg-red-50 p-4 mb-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-red-800",children:h})})]})}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:P,children:[e.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newPassword",className:"sr-only",children:"New Password"}),e.jsx("input",{id:"newPassword",name:"newPassword",type:"password",required:!0,value:l,onChange:a=>j(a.target.value),className:"appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"New Password"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"sr-only",children:"Confirm Password"}),e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",required:!0,value:c,onChange:a=>N(a.target.value),className:"appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Confirm Password"})]})]}),g&&e.jsx("div",{className:"text-sm text-red-600 mt-1",children:g}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Password requirements:"}),e.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[e.jsxs("li",{className:`flex items-center ${s.length?"text-green-600":""}`,children:[e.jsx("svg",{className:`h-4 w-4 mr-2 ${s.length?"text-green-500":"text-gray-400"}`,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:s.length?e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"}):e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z",clipRule:"evenodd"})}),"At least 8 characters"]}),e.jsxs("li",{className:`flex items-center ${s.uppercase?"text-green-600":""}`,children:[e.jsx("svg",{className:`h-4 w-4 mr-2 ${s.uppercase?"text-green-500":"text-gray-400"}`,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:s.uppercase?e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"}):e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z",clipRule:"evenodd"})}),"At least one uppercase letter"]}),e.jsxs("li",{className:`flex items-center ${s.lowercase?"text-green-600":""}`,children:[e.jsx("svg",{className:`h-4 w-4 mr-2 ${s.lowercase?"text-green-500":"text-gray-400"}`,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:s.lowercase?e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"}):e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z",clipRule:"evenodd"})}),"At least one lowercase letter"]}),e.jsxs("li",{className:`flex items-center ${s.number?"text-green-600":""}`,children:[e.jsx("svg",{className:`h-4 w-4 mr-2 ${s.number?"text-green-500":"text-gray-400"}`,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:s.number?e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"}):e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z",clipRule:"evenodd"})}),"At least one number"]}),e.jsxs("li",{className:`flex items-center ${s.special?"text-green-600":""}`,children:[e.jsx("svg",{className:`h-4 w-4 mr-2 ${s.special?"text-green-500":"text-gray-400"}`,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:s.special?e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"}):e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z",clipRule:"evenodd"})}),"At least one special character"]})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:d||!i,className:`group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white ${d||!i?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}`,children:d?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):"Reset Password"})})]}),e.jsx("div",{className:"text-center mt-4",children:e.jsx("a",{href:"/login",className:"font-medium text-indigo-600 hover:text-indigo-500",children:"Back to Login"})})]})})};export{C as default};
