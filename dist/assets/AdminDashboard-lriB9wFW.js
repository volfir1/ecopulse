import{k as ge,r as n,$ as E,N as je,am as be,j as e,B as d,n as ve,T as i,a3 as Ne,V as B,a8 as U,O as oe,W as ie,an as we}from"./index-CeiZKB8G.js";import{Y as De}from"./YearPicker-CopMytEh.js";import{T as Me,a as ce}from"./Tabs-DKAoBmDF.js";import{A as le}from"./activity-C6EwuJId.js";import{R as Se}from"./refresh-cw-DlOnahB6.js";import{G as N}from"./Grid-D1VGGK9h.js";import{S as ee}from"./Stack-DquXuBVl.js";import{p as ke,B as H,X as q,Y as X,q as Ye,R as K,a as ae,T as O,L as _,C as Ee}from"./generateCategoricalChart-D0QOHPu-.js";import{P as Be,a as Re}from"./PieChart-CyEQmZbr.js";import{L as de,a as me}from"./LineChart-BbR2cBpr.js";import{D as Ce}from"./droplets-kF6qgtD3.js";import{C as Pe}from"./Chip-D2qSxnvf.js";import"./AdapterDayjs-J5u3snYC.js";import"./refresh-ccw-DYG20dKq.js";import"./DatePicker-Ds6sJbAa.js";import"./index-D_GLsIW_.js";import"./useThemeProps-B7RzBULZ.js";import"./index-BGHELInD.js";import"./TextField-CJViWXc3.js";import"./Select-CMa9xVQT.js";import"./KeyboardArrowRight-Bas1HYWb.js";import"./styled-ZZIuKTKu.js";/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],he=ge("TrendingUp",We),$e=({initialStartYear:m=2025,initialEndYear:S=2030,onStartYearChange:y,onEndYearChange:o})=>{const[w,P]=n.useState(E().year(m)),[W,$]=n.useState(E().year(S)),[f,v]=n.useState(!1),k=n.useCallback(h=>{const u=E.isDayjs(h)?h:E(h);if(!u||!u.isValid()){v(!0);return}const D=u.year();setLoading(!0),setYearRange(R=>({...R,startYear:D})),v(!1),P(u),y==null||y(D)},[y]),T=n.useCallback(h=>{const u=E.isDayjs(h)?h:E(h);if(!u||!u.isValid()){v(!0);return}const D=u.year();if(u.year()<w.year()){v(!0);return}setLoading(!0),setYearRange(R=>({...R,endYear:D})),v(!1),$(u),o==null||o(D)},[o,w]),c=n.useCallback(()=>{const h=E().year(2025),u=E().year(2030);setLoading(!0),P(h),$(u),setYearRange({startYear:2025,endYear:2030}),y==null||y(h.year()),o==null||o(u.year()),v(!1)},[y,o]);return{startYear:w,endYear:W,error:f,handleStartYearChange:k,handleEndYearChange:T,handleReset:c}};var Ae=ke({chartName:"BarChart",GraphicalChild:H,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:q},{axisType:"yAxis",AxisComp:X}],formatAxisMap:Ye});const re=m=>!m&&m!==0?"-":`${m>=0?"+":""}${m.toFixed(1)}%`,ue=m=>m>0?"text-green-500":m<0?"text-red-500":"text-gray-500",Te="http://127.0.0.1:8000/",Ge=(m={startYear:2025,endYear:2030})=>{const[S,y]=n.useState(!0),[o,w]=n.useState(m),[P,W]=n.useState({totalByYear:[]}),[$,f]=n.useState({pieData:[],performance:[],totalProduction:0,productionIncrease:0,sources:[],regionData:[],efficiencyMetrics:[],usingMockData:!1}),v={overview:n.useRef(null),distribution:n.useRef(null),performance:n.useRef(null)};n.useEffect(()=>{w(m)},[m]);const k=n.useCallback(async(s=o)=>{y(!0);try{const t=[{type:"solar",name:"Solar",endpoint:"/api/predictions/wind/",color:"#FFB800",multiplier:1.2},{type:"hydro",name:"Hydro",endpoint:"/api/predictions/wind/",color:"#2E90E5",multiplier:.8},{type:"wind",name:"Wind",endpoint:"/api/predictions/wind/",color:"#64748B",multiplier:1},{type:"biomass",name:"Biomass",endpoint:"/api/predictions/wind/",color:"#16A34A",multiplier:.5},{type:"geothermal",name:"Geothermal",endpoint:"/api/predictions/wind/",color:"#FF6B6B",multiplier:.4}],p={};let l=0,g=!1;const a={},r=t.map(async({type:b,name:x,endpoint:Z,color:G,multiplier:V})=>{try{const C=await je.get(`${Te}${Z}`,{params:{start_year:s.startYear,end_year:s.endYear}});if(C.data&&C.data.predictions){const A=C.data.predictions.map(se=>{const ne=Math.abs(Number(se["Predicted Production"]))*V,F=Number(se.Year);return a[F]||(a[F]={year:F}),a[F][b.toLowerCase()]=ne,{year:F,value:ne}}),Y=A[A.length-1];l+=Y.value,p[b]={name:x,color:G,data:A,latestValue:Y.value}}}catch(C){console.error(`Error fetching ${b} data:`,C),g=!0;const L=T(b,s.startYear,s.endYear),A=L[L.length-1].value;l+=A,L.forEach(Y=>{a[Y.year]||(a[Y.year]={year:Y.year}),a[Y.year][b.toLowerCase()]=Y.value}),p[b]={name:x,color:G,data:L,latestValue:A}}});await Promise.all(r);const j=Object.values(a).sort((b,x)=>b.year-x.year),M=Object.entries(p).map(([b,x])=>({name:x.name,value:x.latestValue,color:x.color})),I=Object.entries(p).map(([b,x])=>{const Z=x.latestValue/l*100,G=x.data[x.data.length-1],V=x.data[x.data.length-2]||{value:G.value*.9},C=(G.value-V.value)/V.value*100;return{name:x.name,value:Math.round(x.latestValue*10)/10,percentage:Math.min(Z,100),color:x.color,change:C}});I.sort((b,x)=>x.value-b.value);const J=Math.round(l),Q=c(t),ye=h(),pe=u(t),te=l*.9,fe=(l-te)/te*100;W({...p,totalByYear:j}),f({pieData:M,performance:I,totalProduction:J,productionIncrease:Math.round(fe*10)/10,sources:Q,regionData:ye,efficiencyMetrics:pe,maintenance:D(t),usingMockData:g})}catch(t){console.error("Error fetching dashboard data:",t),R(s)}finally{y(!1)}},[o]),T=(s,t,p)=>{const g={solar:r=>700+Math.random()*300+r*90,hydro:r=>800+Math.random()*200+r*60,wind:r=>600+Math.random()*250+r*75,biomass:r=>400+Math.random()*150+r*50,geothermal:r=>500+Math.random()*200+r*45}[s]||(r=>500+Math.random()*200+r*60),a=p-t+1;return Array.from({length:a},(r,j)=>({year:t+j,value:g(j)}))},c=s=>{const t=["Northern Region","Eastern Region","Southern Region","Western Region","Central Region","Coastal Region"],p=["Active","Maintenance","Offline"];return s.flatMap(l=>Array.from({length:3},(g,a)=>({id:`${l.type}-${a+1}`,name:`${t[a%t.length]} ${l.name} ${a+1}`,type:l.name,location:t[a%t.length],status:a===0?"Active":p[Math.floor(Math.random()*p.length)],output:80+Math.random()*200,efficiency:65+Math.floor(Math.random()*30)})))},h=()=>["Northern","Eastern","Southern","Western","Central"].map(t=>({region:t,consumption:500+Math.random()*700})),u=s=>s.map(t=>({name:`${t.name} System Efficiency`,value:70+Math.floor(Math.random()*25)})),D=s=>{const t=["High","Medium","Low"],p=["Routine maintenance and calibration","Equipment upgrade and optimization","Repair and component replacement","System inspection and testing"];return s.slice(0,3).map((l,g)=>{const a=new Date;return a.setDate(a.getDate()+7+g*5),{sourceName:`${l.name} Facility ${g+1}`,type:l.name,priority:t[g%t.length],description:p[g%p.length],scheduledDate:a.toISOString(),duration:`${1+Math.floor(Math.random()*3)} days`}})},R=s=>{const t=[{type:"solar",name:"Solar",color:"#FFB800"},{type:"hydro",name:"Hydro",color:"#2E90E5"},{type:"wind",name:"Wind",color:"#64748B"},{type:"biomass",name:"Biomass",color:"#16A34A"},{type:"geothermal",name:"Geothermal",color:"#FF6B6B"}],p=t.map(({name:r,color:j},M)=>({name:r,value:800-M*120,color:j})),l=t.map(({name:r,color:j},M)=>({name:r,value:800-M*120,percentage:90-M*10,color:j,change:15-M*5})),g=l.reduce((r,j)=>r+j.value,0),a=[];for(let r=s.startYear;r<=s.endYear;r++){const j={year:r};t.forEach(({type:M},I)=>{const J=800-I*120,Q=(r-s.startYear)*50;j[M.toLowerCase()]=J+Q+Math.random()*100}),a.push(j)}W({totalByYear:a}),f({pieData:p,performance:l,totalProduction:g,productionIncrease:12.5,sources:c(t),regionData:h(),efficiencyMetrics:u(t),maintenance:D(t),usingMockData:!0})},z=n.useCallback((s=o)=>{s!==o&&w(s),y(!0),k(s).finally(()=>{y(!1)})},[k,o]);return n.useEffect(()=>{k()},[k]),{loading:S,energyData:P,energySummary:$,yearRange:o,refreshData:z,chartRefs:v}},Le={weeklyGeneration:[{day:"Mon",solar:420,wind:380,hydro:340},{day:"Tue",solar:450,wind:400,hydro:360},{day:"Wed",solar:480,wind:420,hydro:350},{day:"Thu",solar:460,wind:390,hydro:370},{day:"Fri",solar:440,wind:380,hydro:345},{day:"Sat",solar:410,wind:360,hydro:330},{day:"Sun",solar:390,wind:340,hydro:320}]};function xe(m){const{children:S,value:y,index:o,...w}=m;return e.jsx("div",{role:"tabpanel",hidden:y!==o,id:`energy-tabpanel-${o}`,"aria-labelledby":`energy-tab-${o}`,...w,children:y===o&&e.jsx(d,{sx:{py:3},children:S})})}const la=()=>{var z,s,t,p,l,g;const[m,S]=n.useState(0),[y,o]=n.useState(!1),{startYear:w,endYear:P,handleStartYearChange:W,handleEndYearChange:$}=$e({initialStartYear:2025,initialEndYear:2030,onStartYearChange:a=>{v(r=>({...r,startYear:a}))},onEndYearChange:a=>{v(r=>({...r,endYear:a}))}}),[f,v]=n.useState({startYear:w.year(),endYear:P.year()}),{loading:k,energyData:T,energySummary:c,refreshData:h,chartRefs:u}=Ge(f);n.useCallback(be(a=>{h(a)},500),[h]),n.useEffect(()=>{f.startYear&&f.endYear&&h(f)},[f,h]),n.useEffect(()=>{o(c.usingMockData||!1)},[c.usingMockData]);const D=(a,r)=>{S(r)},R=()=>{h(f)};return k?e.jsx(d,{className:"p-6 max-w-7xl mx-auto flex justify-center items-center h-screen",children:e.jsx(ve,{})}):e.jsxs(d,{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs(d,{className:"flex justify-between items-center mb-6",children:[e.jsxs(d,{children:[e.jsx(i,{variant:"h4",className:"font-bold",children:"Energy Management Dashboard"}),e.jsx(i,{variant:"body1",color:"textSecondary",children:"System overview and performance metrics"})]}),e.jsx(d,{className:"flex items-center gap-3",children:e.jsx(De,{initialStartYear:f.startYear,initialEndYear:f.endYear,onStartYearChange:W,onEndYearChange:$,usingMockData:y})})]}),e.jsx(d,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(Me,{value:m,onChange:D,"aria-label":"energy dashboard tabs",children:[e.jsx(ce,{label:"Overview",icon:e.jsx(le,{size:16}),iconPosition:"start"}),e.jsx(ce,{label:"Energy",icon:e.jsx(he,{size:16}),iconPosition:"start"}),e.jsx(Ne,{variant:"contained",color:"primary",startIcon:e.jsx(Se,{size:18}),onClick:R,sx:{fontSize:"0.7rem",padding:"0px 10px",minWidth:"150px",height:"2.5rem",marginTop:"1rem",borderRadius:"30px"},children:"Refresh Data"})]})}),e.jsxs(xe,{value:m,index:0,children:[e.jsxs(N,{container:!0,spacing:3,className:"mb-6",children:[e.jsx(N,{item:!0,xs:12,md:4,children:e.jsx(B,{elevation:0,className:"p-4 border rounded-lg hover:shadow-md transition-shadow",children:e.jsxs(ee,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(U,{sx:{bgcolor:"primary.main",width:48,height:48},children:e.jsx(he,{})}),e.jsxs(d,{children:[e.jsxs(i,{variant:"h5",className:"font-bold",children:[c.totalProduction||"3250"," GWh"]}),e.jsxs(d,{className:"flex items-center",children:[e.jsxs(i,{variant:"body2",color:"success.main",className:"font-medium mr-1",children:["+",c.productionIncrease||"12.5","%"]}),e.jsx(i,{variant:"body2",color:"textSecondary",children:"year over year"})]}),e.jsx(i,{variant:"body2",className:"mt-1",color:"textSecondary",children:"Total Energy Production"})]})]})})}),e.jsx(N,{item:!0,xs:12,md:4,children:e.jsx(B,{elevation:0,className:"p-4 border rounded-lg hover:shadow-md transition-shadow",children:e.jsxs(ee,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(U,{sx:{bgcolor:"success.main",width:48,height:48},children:e.jsx(oe,{})}),e.jsxs(d,{children:[e.jsxs(i,{variant:"h5",className:"font-bold",children:[((z=c.performance.find(a=>a.name==="Solar"))==null?void 0:z.value)||320," GWh"]}),e.jsxs(d,{className:"flex items-center",children:[e.jsx(i,{variant:"body2",className:`font-medium mr-1 ${ue(((s=c.performance.find(a=>a.name==="Solar"))==null?void 0:s.change)||15.2)}`,children:re(((t=c.performance.find(a=>a.name==="Solar"))==null?void 0:t.change)||15.2)}),e.jsx(i,{variant:"body2",color:"textSecondary",children:"vs last year"})]}),e.jsx(i,{variant:"body2",className:"mt-1",color:"textSecondary",children:"Solar Generation"})]})]})})}),e.jsx(N,{item:!0,xs:12,md:4,children:e.jsx(B,{elevation:0,className:"p-4 border rounded-lg hover:shadow-md transition-shadow",children:e.jsxs(ee,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(U,{sx:{bgcolor:"warning.main",width:48,height:48},children:e.jsx(ie,{})}),e.jsxs(d,{children:[e.jsxs(i,{variant:"h5",className:"font-bold",children:[((p=c.performance.find(a=>a.name==="Wind"))==null?void 0:p.value)||250," GWh"]}),e.jsxs(d,{className:"flex items-center",children:[e.jsx(i,{variant:"body2",className:`font-medium mr-1 ${ue(((l=c.performance.find(a=>a.name==="Wind"))==null?void 0:l.change)||8.7)}`,children:re(((g=c.performance.find(a=>a.name==="Wind"))==null?void 0:g.change)||8.7)}),e.jsx(i,{variant:"body2",color:"textSecondary",children:"vs last year"})]}),e.jsx(i,{variant:"body2",className:"mt-1",color:"textSecondary",children:"Wind Generation"})]})]})})})]}),e.jsx(N,{container:!0,spacing:3,className:"mb-6",children:e.jsx(N,{item:!0,xs:12,children:e.jsxs(B,{className:"p-4 border rounded-lg h-full",children:[e.jsx(i,{variant:"h6",className:"mb-3 font-semibold",children:"Energy Generation Overview"}),e.jsx(d,{className:"h-80",ref:u.overview,children:e.jsx(K,{width:"100%",height:"100%",children:e.jsxs(Ae,{data:Le.weeklyGeneration,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(ae,{strokeDasharray:"3 3",vertical:!1}),e.jsx(q,{dataKey:"day"}),e.jsx(X,{}),e.jsx(O,{}),e.jsx(_,{}),e.jsx(H,{dataKey:"solar",name:"Solar",fill:"#FFB800",radius:[4,4,0,0],barSize:20}),e.jsx(H,{dataKey:"wind",name:"Wind",fill:"#64748B",radius:[4,4,0,0],barSize:20}),e.jsx(H,{dataKey:"hydro",name:"Hydro",fill:"#2E90E5",radius:[4,4,0,0],barSize:20})]})})})]})})}),e.jsxs(N,{container:!0,spacing:3,children:[e.jsx(N,{item:!0,xs:12,md:6,children:e.jsxs(B,{className:"p-4 border rounded-lg",children:[e.jsx(i,{variant:"h6",className:"mb-3 font-semibold",children:"Energy Source Distribution"}),e.jsx(d,{className:"h-64",ref:u.distribution,children:e.jsx(K,{width:"100%",height:"100%",children:e.jsxs(Be,{children:[e.jsx(Re,{data:c.pieData,cx:"50%",cy:"50%",innerRadius:30,outerRadius:80,paddingAngle:2,dataKey:"value",nameKey:"name",label:({name:a,percent:r})=>`${a}: ${(r*100).toFixed(1)}%`,children:c.pieData.map((a,r)=>e.jsx(Ee,{fill:a.color},`cell-${r}`))}),e.jsx(O,{formatter:a=>[`${a.toFixed(1)} GWh`,"Generation"]}),e.jsx(_,{layout:"vertical",align:"right",verticalAlign:"middle"})]})})})]})}),e.jsx(N,{item:!0,xs:12,md:6,children:e.jsxs(B,{className:"p-4 border rounded-lg h-full",children:[e.jsx(i,{variant:"h6",className:"mb-3 font-semibold",children:"Yearly Energy Forecast"}),e.jsx(d,{className:"h-64",children:e.jsx(K,{width:"100%",height:"100%",children:e.jsxs(de,{data:[{year:2025,value:3250},{year:2026,value:3680},{year:2027,value:4120},{year:2028,value:4580},{year:2029,value:5100},{year:2030,value:5650}],margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(ae,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"year"}),e.jsx(X,{}),e.jsx(O,{formatter:a=>[`${a} GWh`,"Total Production"]}),e.jsx(_,{}),e.jsx(me,{type:"monotone",dataKey:"value",name:"Total Energy Production",stroke:"#6366f1",strokeWidth:2,dot:{r:4},activeDot:{r:6}})]})})})]})})]})]}),e.jsxs(xe,{value:m,index:1,children:[e.jsx(d,{className:"mb-4 flex justify-between",children:e.jsx(i,{variant:"h5",children:"Energy Management"})}),e.jsx(N,{container:!0,spacing:3,className:"mb-6",children:c.performance&&c.performance.map(a=>e.jsx(N,{item:!0,xs:12,md:4,children:e.jsxs(B,{className:"p-4 border rounded-lg",children:[e.jsxs(d,{className:"flex justify-between mb-2",children:[e.jsxs(d,{className:"flex items-center",children:[a.name==="Solar"&&e.jsx(oe,{size:20,className:"text-yellow-500 mr-2"}),a.name==="Wind"&&e.jsx(ie,{size:20,className:"text-slate-500 mr-2"}),a.name==="Hydro"&&e.jsx(Ce,{size:20,className:"text-blue-500 mr-2"}),!["Solar","Wind","Hydro"].includes(a.name)&&e.jsx(le,{size:20,className:"text-gray-500 mr-2"}),e.jsx(i,{variant:"h6",children:a.name})]}),e.jsx(Pe,{label:re(a.change),size:"small",color:a.change>=0?"success":"error"})]}),e.jsxs(i,{variant:"h4",className:"font-bold mb-2",style:{color:a.color},children:[a.value," GWh"]}),e.jsxs(i,{variant:"body2",color:"textSecondary",className:"mb-2",children:[a.percentage.toFixed(1),"% of total generation"]}),e.jsx(we,{variant:"determinate",value:a.percentage,sx:{height:8,borderRadius:4,bgcolor:"#f3f4f6","& .MuiLinearProgress-bar":{bgcolor:a.color}}})]})},a.name))}),e.jsxs(B,{className:"p-4 border rounded-lg mb-6",children:[e.jsx(i,{variant:"h6",className:"mb-3 font-semibold",children:"Yearly Energy Production Trends"}),e.jsx(d,{className:"h-96",children:e.jsx(K,{width:"100%",height:"100%",children:e.jsxs(de,{data:T.totalByYear||[],margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(ae,{strokeDasharray:"3 3",vertical:!1}),e.jsx(q,{dataKey:"year",type:"number",domain:[f.startYear,f.endYear],tickCount:Math.min(6,f.endYear-f.startYear+1)}),e.jsx(X,{}),e.jsx(O,{}),e.jsx(_,{}),c.pieData&&c.pieData.map(a=>e.jsx(me,{type:"monotone",dataKey:a.name.toLowerCase(),name:a.name,stroke:a.color,strokeWidth:2,dot:{r:4},activeDot:{r:6}},a.name))]})})})]})]})]})};export{la as default};
