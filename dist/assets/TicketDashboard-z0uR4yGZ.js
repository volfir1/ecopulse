import{k as b,b as I,e as D,r as x,j as e,B as s,T as t,q as o,a1 as l,Y as z,g as S,v as T,a as B,P as g,ad as j,R as P,D as M}from"./index-BN0NLy4X.js";import{t as A}from"./ticketService-BUEzRzQk.js";import{R as N}from"./refresh-cw-CWf_GyjV.js";import{C as c}from"./Chip-BQdj-Ugh.js";import{A as u}from"./arrow-up-right-l_fJs2qG.js";import{G as a}from"./Grid-CgXu5irq.js";import"./axios-CmsuhreG.js";/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],L=b("ArrowDownRight",_);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M13 17V9",key:"1fwyjl"}],["path",{d:"M18 17V5",key:"sfb6ij"}],["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M8 17v-3",key:"17ska0"}]],$=b("ChartColumnIncreasing",U);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],O=b("Users",H),X=()=>{const f=I(),p=D(),[F,y]=x.useState(!0),[r,w]=x.useState({tickets:{total:0,open:0,inProgress:0,resolved:0,closed:0,unassigned:0},responseTime:{average:0,change:0},resolution:{rate:0,change:0},userSatisfaction:{rate:0,change:0}}),[m,E]=x.useState([]);x.useEffect(()=>{(async()=>{y(!0);try{const n=await A.getTicketStats();n.data&&w(h=>({...h,tickets:{total:n.data.total||0,open:n.data.open||0,inProgress:n.data.inProgress||0,resolved:n.data.resolved||0,closed:n.data.closed||0,unassigned:n.data.unassigned||0},responseTime:{average:2.4,change:-5.2},resolution:{rate:87,change:3.8},userSatisfaction:{rate:92,change:1.5}}));const d=await A.getAllTickets();E(d.data.slice(0,5))}catch(n){console.error("Error fetching dashboard data:",n),p.error("Failed to load dashboard data")}finally{y(!1)}})()},[p]);const W=i=>{switch(i){case"open":return{bg:"#EEF7FF",color:"#1A73E8"};case"in-progress":return{bg:"#FFF7E0",color:"#F29D41"};case"resolved":return{bg:"#E7F7ED",color:"#34A853"};case"closed":return{bg:"#F2F2F2",color:"#5F6368"};default:return{bg:"#F2F2F2",color:"#5F6368"}}},R=i=>{const n=new Date(i);return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(n)};return F?e.jsx(s,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"70vh"},children:e.jsx(N,{className:"animate-spin text-primary",size:40})}):e.jsxs("div",{className:"container mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(t,{variant:"h4",fontWeight:"bold",color:"text.primary",children:"Dashboard"}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Overview of support ticket metrics and activity"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsx(o.Base,{children:e.jsxs(s,{sx:{p:3},children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[e.jsxs(s,{children:[e.jsx(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Total Tickets"}),e.jsx(t,{variant:"h4",fontWeight:"bold",children:r.tickets.total})]}),e.jsx(l,{sx:{backgroundColor:"rgba(21, 101, 192, 0.1)",color:"#1565C0",width:40,height:40},children:e.jsx(z,{name:"ticket",size:20})})]}),e.jsx(s,{sx:{display:"flex",alignItems:"center"},children:e.jsx(c,{size:"small",icon:e.jsx(u,{size:14}),label:"8.5% vs last week",sx:{backgroundColor:"rgba(52, 168, 83, 0.1)",color:"#34A853",fontSize:"0.75rem"}})})]})}),e.jsx(o.Base,{children:e.jsxs(s,{sx:{p:3},children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[e.jsxs(s,{children:[e.jsx(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Average Response"}),e.jsxs(t,{variant:"h4",fontWeight:"bold",children:[r.responseTime.average,"h"]})]}),e.jsx(l,{sx:{backgroundColor:"rgba(245, 124, 0, 0.1)",color:"#F57C00",width:40,height:40},children:e.jsx(S,{size:20})})]}),e.jsx(s,{sx:{display:"flex",alignItems:"center"},children:e.jsx(c,{size:"small",icon:e.jsx(L,{size:14}),label:`${Math.abs(r.responseTime.change)}% vs last week`,sx:{backgroundColor:r.responseTime.change<0?"rgba(52, 168, 83, 0.1)":"rgba(234, 67, 53, 0.1)",color:r.responseTime.change<0?"#34A853":"#EA4335",fontSize:"0.75rem"}})})]})}),e.jsx(o.Base,{children:e.jsxs(s,{sx:{p:3},children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[e.jsxs(s,{children:[e.jsx(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Resolution Rate"}),e.jsxs(t,{variant:"h4",fontWeight:"bold",children:[r.resolution.rate,"%"]})]}),e.jsx(l,{sx:{backgroundColor:"rgba(52, 168, 83, 0.1)",color:"#34A853",width:40,height:40},children:e.jsx(T,{size:20})})]}),e.jsx(s,{sx:{display:"flex",alignItems:"center"},children:e.jsx(c,{size:"small",icon:e.jsx(u,{size:14}),label:`${r.resolution.change}% vs last week`,sx:{backgroundColor:r.resolution.change>0?"rgba(52, 168, 83, 0.1)":"rgba(234, 67, 53, 0.1)",color:r.resolution.change>0?"#34A853":"#EA4335",fontSize:"0.75rem"}})})]})}),e.jsx(o.Base,{children:e.jsxs(s,{sx:{p:3},children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[e.jsxs(s,{children:[e.jsx(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"User Satisfaction"}),e.jsxs(t,{variant:"h4",fontWeight:"bold",children:[r.userSatisfaction.rate,"%"]})]}),e.jsx(l,{sx:{backgroundColor:"rgba(26, 115, 232, 0.1)",color:"#1A73E8",width:40,height:40},children:e.jsx(O,{size:20})})]}),e.jsx(s,{sx:{display:"flex",alignItems:"center"},children:e.jsx(c,{size:"small",icon:e.jsx(u,{size:14}),label:`${r.userSatisfaction.change}% vs last week`,sx:{backgroundColor:r.userSatisfaction.change>0?"rgba(52, 168, 83, 0.1)":"rgba(234, 67, 53, 0.1)",color:r.userSatisfaction.change>0?"#34A853":"#EA4335",fontSize:"0.75rem"}})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(o.Base,{children:e.jsxs(s,{sx:{p:3},children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(t,{variant:"h6",fontWeight:"bold",children:"Tickets by Status"}),e.jsx(B,{variant:"outlined",size:"small",onClick:()=>f("/admin/ticket "),children:"View All"})]}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{item:!0,xs:6,md:3,children:e.jsxs(g,{elevation:0,sx:{p:2,textAlign:"center",backgroundColor:"#EEF7FF",borderRadius:2},children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"#1A73E8",children:r.tickets.open}),e.jsx(t,{variant:"body2",color:"#1A73E8",children:"Open"})]})}),e.jsx(a,{item:!0,xs:6,md:3,children:e.jsxs(g,{elevation:0,sx:{p:2,textAlign:"center",backgroundColor:"#FFF7E0",borderRadius:2},children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"#F29D41",children:r.tickets.inProgress}),e.jsx(t,{variant:"body2",color:"#F29D41",children:"In Progress"})]})}),e.jsx(a,{item:!0,xs:6,md:3,children:e.jsxs(g,{elevation:0,sx:{p:2,textAlign:"center",backgroundColor:"#E7F7ED",borderRadius:2},children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"#34A853",children:r.tickets.resolved}),e.jsx(t,{variant:"body2",color:"#34A853",children:"Resolved"})]})}),e.jsx(a,{item:!0,xs:6,md:3,children:e.jsxs(g,{elevation:0,sx:{p:2,textAlign:"center",backgroundColor:"#FFEBEE",borderRadius:2},children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"#E53935",children:r.tickets.unassigned}),e.jsx(t,{variant:"body2",color:"#E53935",children:"Unassigned"})]})})]}),e.jsxs(s,{sx:{mt:4},children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsx(t,{variant:"body2",fontWeight:"medium",children:"Open Tickets"}),e.jsxs(t,{variant:"body2",fontWeight:"medium",children:[r.tickets.open," / ",r.tickets.total]})]}),e.jsx(j,{variant:"determinate",value:r.tickets.open/r.tickets.total*100,sx:{height:8,borderRadius:4,backgroundColor:"rgba(26, 115, 232, 0.1)","& .MuiLinearProgress-bar":{backgroundColor:"#1A73E8"}}})]}),e.jsxs(s,{sx:{mt:2},children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsx(t,{variant:"body2",fontWeight:"medium",children:"In Progress Tickets"}),e.jsxs(t,{variant:"body2",fontWeight:"medium",children:[r.tickets.inProgress," / ",r.tickets.total]})]}),e.jsx(j,{variant:"determinate",value:r.tickets.inProgress/r.tickets.total*100,sx:{height:8,borderRadius:4,backgroundColor:"rgba(242, 157, 65, 0.1)","& .MuiLinearProgress-bar":{backgroundColor:"#F29D41"}}})]}),e.jsxs(s,{sx:{mt:2},children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsx(t,{variant:"body2",fontWeight:"medium",children:"Resolved Tickets"}),e.jsxs(t,{variant:"body2",fontWeight:"medium",children:[r.tickets.resolved," / ",r.tickets.total]})]}),e.jsx(j,{variant:"determinate",value:r.tickets.resolved/r.tickets.total*100,sx:{height:8,borderRadius:4,backgroundColor:"rgba(52, 168, 83, 0.1)","& .MuiLinearProgress-bar":{backgroundColor:"#34A853"}}})]})]})})}),e.jsx("div",{children:e.jsx(o.Base,{sx:{height:"100%"},children:e.jsxs(s,{sx:{p:3},children:[e.jsx(t,{variant:"h6",fontWeight:"bold",gutterBottom:!0,children:"Recent Activity"}),m.length>0?e.jsx(s,{children:m.map((i,n)=>{var d,h,v,k,C;return e.jsxs(P.Fragment,{children:[e.jsxs(s,{sx:{display:"flex",py:2,cursor:"pointer"},onClick:()=>f(`/admin/tickets/${i._id}`),children:[e.jsx(l,{src:(d=i.user)==null?void 0:d.profilePicture,sx:{width:36,height:36,mr:2},children:((v=(h=i.user)==null?void 0:h.firstName)==null?void 0:v.charAt(0))||((C=(k=i.user)==null?void 0:k.email)==null?void 0:C.charAt(0))}),e.jsxs(s,{children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:[e.jsx(t,{variant:"body2",fontWeight:"medium",noWrap:!0,children:i.subject}),e.jsx(c,{label:i.status.replace("-"," "),size:"small",sx:{...W(i.status),textTransform:"capitalize",fontWeight:"medium",fontSize:"0.65rem",height:20}})]}),e.jsx(t,{variant:"caption",color:"text.secondary",children:R(i.updatedAt)})]})]}),n<m.length-1&&e.jsx(M,{})]},i._id)})}):e.jsx(s,{sx:{py:4,textAlign:"center"},children:e.jsx(t,{variant:"body2",color:"text.secondary",children:"No recent activity"})})]})})})]}),e.jsx("div",{className:"mb-6",children:e.jsx(o.Base,{children:e.jsxs(s,{sx:{p:3},children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(t,{variant:"h6",fontWeight:"bold",children:"Tickets by Priority"}),e.jsx($,{size:20})]}),e.jsxs(a,{container:!0,spacing:3,children:[e.jsx(a,{item:!0,xs:6,md:3,children:e.jsxs(s,{sx:{textAlign:"center"},children:[e.jsx(s,{sx:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:64,height:64,borderRadius:"50%",backgroundColor:"#E7F7ED",mb:2},children:e.jsx(t,{variant:"h6",fontWeight:"bold",color:"#34A853",children:"42%"})}),e.jsx(t,{variant:"body2",fontWeight:"medium",children:"Low"})]})}),e.jsx(a,{item:!0,xs:6,md:3,children:e.jsxs(s,{sx:{textAlign:"center"},children:[e.jsx(s,{sx:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:64,height:64,borderRadius:"50%",backgroundColor:"#FFF7E0",mb:2},children:e.jsx(t,{variant:"h6",fontWeight:"bold",color:"#F29D41",children:"35%"})}),e.jsx(t,{variant:"body2",fontWeight:"medium",children:"Medium"})]})}),e.jsx(a,{item:!0,xs:6,md:3,children:e.jsxs(s,{sx:{textAlign:"center"},children:[e.jsx(s,{sx:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:64,height:64,borderRadius:"50%",backgroundColor:"#FFEBEE",mb:2},children:e.jsx(t,{variant:"h6",fontWeight:"bold",color:"#E53935",children:"18%"})}),e.jsx(t,{variant:"body2",fontWeight:"medium",children:"High"})]})}),e.jsx(a,{item:!0,xs:6,md:3,children:e.jsxs(s,{sx:{textAlign:"center"},children:[e.jsx(s,{sx:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:64,height:64,borderRadius:"50%",backgroundColor:"#7F1D1D20",mb:2},children:e.jsx(t,{variant:"h6",fontWeight:"bold",color:"#7F1D1D",children:"5%"})}),e.jsx(t,{variant:"body2",fontWeight:"medium",children:"Urgent"})]})})]})]})})})]})};export{X as default};
